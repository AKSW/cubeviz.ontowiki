var CubeViz_ConfigurationLink=(function(){function b(){}b.save=function a(d,c,g,e,j,h){if(typeof h==="undefined"){h=false}var i=$.ajaxSetup();var f=$.support.cors;$.ajaxSetup({async:true,cache:false,type:"POST"});$.support.cors=true;$.ajax({url:d+"savecontenttofile/",data:{modelIri:c,stringifiedContent:JSON.stringify(g),type:e,useObservations:true===h?"true":"false"}}).error(function(m,k,l){$.ajaxSetup(i);$.support.cors=f;throw new Error("save error: "+m.responseText)}).done(function(k){$.ajaxSetup(i);$.support.cors=f;j(k)})};return b})();var CubeViz_Collection=(function(){function a(b){this.reset(b)}a.prototype.add=function(b,c){if(true===_.isUndefined(b[this.idKey])){throw new Error("Key "+this.idKey+" in element not set!");return this}if(undefined===this.get(b[this.idKey])){this._.push(b)}else{if((undefined!==c&&undefined!==c.merge&&c.merge==true)){this.remove(b[this.idKey]);this._.push(b)}}return this};a.prototype.addList=function(c){var b=this;if(true==_.isArray(c)){_.each(c,function(d){b.add(d)})}else{if(true==_.isObject(c)){this.addList(_.values(c))}}return b};a.prototype.each=function(b){_.each(this._,b);return this};a.prototype.exists=function(b){return false===_.isUndefined(this.get(b))};a.prototype.get=function(d){var b=this;var c=_.filter(this._,function(e){if(e[b.idKey]==d){return true}else{return false}});return 1==c.length?c[0]:undefined};a.prototype.getFirst=function(){return _.first(this._)};a.prototype.remove=function(c){var b=this;this._=_.reject(this._,function(d){return d[b.idKey]==c});return this};a.prototype.reset=function(b){this.idKey=undefined===b?(undefined===this.idKey?"id":this.idKey):b;this._=[];return this};a.prototype.size=function(){return _.size(this._)};a.prototype.sortAscendingBy=function(g){var f="";var e="";var j="";var i="";var h=false===_.isUndefined(g)?g:this.idKey;this._.sort(function(d,c){try{try{j=parseFloat(d[h]);i=parseFloat(c[h]);if(true===_.isNaN(j)||true===_.isNaN(i)){throw new Error()}}catch(k){j=d[h].toUpperCase();i=c[h].toUpperCase()}return(j<i)?-1:(j>i)?1:0}catch(l){}});return this};a.prototype.toObject=function(){var b=0;var c={};_.each(this._,function(d){c[b++]=d});return c};return a})();var CubeViz_Visualization=(function(){function CubeViz_Visualization(){}CubeViz_Visualization.prototype.getName=function(){return this.name};CubeViz_Visualization.prototype.getSupportedClassNames=function(){return this.supportedClassNames};CubeViz_Visualization.prototype.load=function(c){if(true===this.isResponsibleFor(c)){var chartInstance;eval("chartInstance = new "+c+"();");return chartInstance}throw new Error("Invalid c ("+c+") given!")};CubeViz_Visualization.prototype.isResponsibleFor=function(className){return _.contains(this.getSupportedClassNames(),className)};return CubeViz_Visualization})();var CubeViz_View_Abstract=(function(){function a(d,b,c){this.app=c;this.attachedTo=b;this.autostart=false;this.collection=new CubeViz_Collection();this.id=d||"view"}a.prototype.bindGlobalEvents=function(b){this.app.bindGlobalEvents(b,this);return this};a.prototype.bindUserInterfaceEvents=function(e){if(true===_.isUndefined(e)||0==_.size(e)){return}var d="";var b="";var c=this;_.each(e,function(g,f){if(false===_.isFunction(g)){g=c[g]}if(!g){throw new Error("Method "+g+" does not exist")}d=f.substr(0,f.indexOf(" "));b=f.substr(f.indexOf(" ")+1);$(b).on(d,$.proxy(g,c))})};a.prototype.destroy=function(){var b=$(this.attachedTo);b.off();if(true===b.is("div")){b.empty()}else{if(true===b.is("select")){b.find("option").remove()}}this.collection.reset();return this};a.prototype.initialize=function(){};a.prototype.triggerGlobalEvent=function(b,c){this.app.triggerEvent(b,c);return this};return a})();var CubeViz_View_Application=(function(){function CubeViz_View_Application(){this._viewInstances=new CubeViz_Collection();this._eventHandlers=new CubeViz_Collection();this._={}}CubeViz_View_Application.prototype.add=function(id,attachedTo,merge){var options=true===merge?{merge:true}:undefined;var viewObj={alreadyRendered:false,attachedTo:attachedTo,id:id,instance:null};eval("viewObj.instance = new "+id+'("'+attachedTo+'", this);');this._viewInstances.add(viewObj,options);return this};CubeViz_View_Application.prototype.bindGlobalEvents=function(events,callee){if(true===_.isUndefined(events)||0==_.size(events)){return this}var self=this;_.each(events,function(event){$(self).on(event.name,$.proxy(event.handler,callee))});return this};CubeViz_View_Application.prototype.destroyView=function(id){this._viewInstances.get(id).instance.destroy();return this};CubeViz_View_Application.prototype.get=function(id){return this._viewInstances.get(id)};CubeViz_View_Application.prototype.getDataCopy=function(){var backup=[this._.generatedVisualization];this._.generatedVisualization=undefined;var result=$.parseJSON(JSON.stringify(this._));this._.generatedVisualization=backup[1];return result};CubeViz_View_Application.prototype.remove=function(id){this._viewInstances.remove(id);return this};CubeViz_View_Application.prototype.renderAll=function(){var self=this;_.each(this._viewInstances._,function(view){self.renderView(view.id,view.attachedTo)});return this};CubeViz_View_Application.prototype.renderView=function(id,attachedTo){this.add(id,attachedTo).destroyView(id).get(id).instance.initialize();return this};CubeViz_View_Application.prototype.reset=function(){$(this).off();var self=this;_.each(this._viewInstances._,function(view){self.destroyView(view.id).add(view.id,view.attachedTo,true)});return this};CubeViz_View_Application.prototype.restoreDataCopy=function(copy){this._=$.parseJSON(JSON.stringify(copy));return this};CubeViz_View_Application.prototype.triggerEvent=function(eventName,data){$(this).trigger(eventName,[data]);return this};CubeViz_View_Application.prototype.unbindEvent=function(eventName){$(this).off(eventName);return this};return CubeViz_View_Application})();var CubeViz_View_Helper=(function(){function f(){}f.attachDialogTo=function k(p,o){var n={};var o=o||{};n.autoOpen=o.autoOpen||false;n.closeOnEscape=o.closeOnEscape||false;n.draggable=o.draggable||false;n.height=o.height||"auto";n.hide=o.hide||"slow";n.modal=o.modal||true;n.overlay=o.overlay||{"background-color":"#FFFFFF",opacity:0.5};n.resizable=o.resizable||false;n.show=o.show||"slow";n.width=o.width||"700";if(true===_.isUndefined(o.showCross)||false===o.showCross){n.open=function(q,r){$(".ui-dialog-titlebar-close",$(this).parent()).hide()}}p.dialog(n);p.data("hasDialog",true)};f.closeDialog=function e(n){n.dialog("close");n.data("isDialogOpen",false)};f.destroyDialog=function m(n){n.dialog("destroy");n.data("isDialogOpen",false)};f.hideCloseAndUpdateSpinner=function j(n){$(n.find(".cubeviz-dataSelectionModule-closeUpdateSpinner").first()).hide()};f.hideLeftSidebarSpinner=function c(){$("#cubeviz-dataSelectionModule-spinnerIcon").hide();$("#cubeviz-dataSelectionModule-spinnerText").hide();$("#cubeviz-dataSelectionModule-spinner").fadeOut("slow",function(){$("#cubeviz-dataSelectionModule-dataSelection").fadeIn("slow")})};f.openDialog=function d(n){n.dialog("open");n.data("isDialogOpen",true);$(".ui-widget-overlay").css("height",2*screen.height)};f.showCloseAndUpdateSpinner=function i(n){$(n.find(".cubeviz-dataSelectionModule-closeUpdateSpinner").first()).show()};f.showLeftSidebarSpinner=function b(){$("#cubeviz-dataSelectionModule-spinnerIcon").show();$("#cubeviz-dataSelectionModule-spinnerText").show();$("#cubeviz-dataSelectionModule-dataSelection").fadeOut("slow",function(){$("#cubeviz-dataSelectionModule-spinner").fadeIn("slow").show()})};f.sortLiItemsByAlphabet=function h(r){var o="";var n="";var q={};var p=[];r.sort(function(t,s){t=$(t).text().toUpperCase();s=$(s).text().toUpperCase();return(t<s)?-1:(t>s)?1:0});_.each(r,function(s){q=$(s).data("data");s=$(s).clone();$(s).data("data",q);p.push(s)});return p};f.sortLiItemsByCheckStatus=function l(q){var p={};var n=[];var o=[];_.each(q,function(r){if($($(r).children().first()).is(":checked")){p=$(r).data("data");r=$(r).clone();$(r).data("data",p);o.push(r)}else{n.push(r)}});_.each(n,function(r){p=$(r).data("data");r=$(r).clone();$(r).data("data",p);o.push(r)});return o};f.sortLiItemsByObservationCount=function a(s,u,t){var n="";var r=[];var p=[];var q=0;var o=[];_.each(s,function(v){n=$($(v).children().first()).val();q=0;_.each(t,function(w){if(n===w[u][0].value){++q}});$(v).data("observationCount",q);if(0<q){o.push($(v).clone())}else{p.push(v)}});o.sort(function(w,v){w=$(w).data("observationCount");v=$(v).data("observationCount");return(w<v)?1:(w>v)?-1:0});_.each(p,function(v){o.push($(v).clone())});return o};f.tplReplace=function g(n,p){if(true===_.isUndefined(p)){return n}var o=_.keys(p);_.each(o,function(q){n=n.replace("[["+q+"]]",_.str.trim(p[q]))});return _.str.trim(n)};return f})();var CubeViz_Visualization_Controller=(function(){function CubeViz_Visualization_Controller(){}CubeViz_Visualization_Controller.getColor=function getColor(variable){var color="#FFFFFF";if(true===_.isString(variable)||true===_.isNumber(variable)){color=""+CryptoJS.MD5(variable);color="#"+color.substr((color.length-6),6)}else{if(false===_.isUndefined(variable)){color=JSON.stringify(variable);color="#"+color.substr((color.length-6),6)}}return color};CubeViz_Visualization_Controller.getFromChartConfigByClass=function getFromChartConfigByClass(className,charts){var result=undefined;_.each(charts,function(chart){if(true===_.isUndefined(result)){if(className==chart.className){result=chart}}});return result};CubeViz_Visualization_Controller.getMultipleDimensions=function getMultipleDimensions(selectedComponentDimensions){var multipleDimensions=[];_.each(selectedComponentDimensions,function(selectedDimension){if(2<=_.keys(selectedDimension.__cv_elements).length){multipleDimensions.push(selectedDimension)}});return multipleDimensions};CubeViz_Visualization_Controller.getObjectValueByKeyString=function getObjectValueByKeyString(keyString,objToAccess){var call="objToAccess";var result=undefined;try{_.each(keyString.split("."),function(key){call+="."+key});eval("result = "+call)}catch(ex){}return result};CubeViz_Visualization_Controller.getOneElementDimensions=function getOneElementDimensions(selectedComponentDimensions){var oneElementDimensions=[];_.each(selectedComponentDimensions,function(selectedDimension){if(1==_.keys(selectedDimension.__cv_elements).length){oneElementDimensions.push(selectedDimension)}});return oneElementDimensions};CubeViz_Visualization_Controller.getVisualizationType=function getVisualizationType(className){var hC=new CubeViz_Visualization_HighCharts();if(true===hC.isResponsibleFor(className)){return hC.getName()}throw new Error("Unknown className "+className)};CubeViz_Visualization_Controller.linkify=function linkify(inputText){var emailAddressPattern=/\w+@[a-zA-Z_]+?(?:\.[a-zA-Z]{2,6})+/gim;var pseudoUrlPattern=/(^|[^\/])(www\.[\S]+(\b|$))/gim;var urlPattern=/\b(?:https?|ftp):\/\/[a-z0-9-+&@#\/%?=~_|!:,.;]*[a-z0-9-+&@#\/%=~_|]/gim;return inputText.replace(urlPattern,'<a href="$&" target="_blank">$&</a>').replace(pseudoUrlPattern,'$1<a href="http://$2" target="_blank">$2</a>').replace(emailAddressPattern,'<a href="mailto:$&">$&</a>')};CubeViz_Visualization_Controller.setChartConfigClassEntry=function setChartConfigClassEntry(className,charts,newValue){for(var i in charts){if(className==charts[i].className){charts[i]=newValue}}};CubeViz_Visualization_Controller.updateVisualizationSettings=function updateVisualizationSettings(menuItemValues,visualizationSetting,chartConfigEntryDefaultConfig){var call="";var optionKey="";var optionVal="";var updatedSetting=visualizationSetting||{};if(0===_.keys(updatedSetting).length){updatedSetting=chartConfigEntryDefaultConfig}updatedSetting=$.parseJSON(JSON.stringify(updatedSetting));_.each(menuItemValues,function(menuItemValue){optionKey=$(menuItemValue).data("key");optionVal=$(menuItemValue).val();if(true===_.isUndefined(optionKey)){return}call="updatedSetting";_.each(optionKey.split("."),function(key){call+="."+key;eval(call+" = "+call+" || {};")});eval(call+" = optionVal;")});return updatedSetting};return CubeViz_Visualization_Controller})();var __extends=this.__extends||function(e,a){function c(){this.constructor=e}c.prototype=a.prototype;e.prototype=new c()};var CubeViz_Visualization_HighCharts=(function(b){__extends(a,b);function a(){b.call(this);this.name="HighCharts";this.supportedClassNames=["CubeViz_Visualization_HighCharts_Area","CubeViz_Visualization_HighCharts_AreaSpline","CubeViz_Visualization_HighCharts_Bar","CubeViz_Visualization_HighCharts_Column","CubeViz_Visualization_HighCharts_Line","CubeViz_Visualization_HighCharts_Pie","CubeViz_Visualization_HighCharts_Polar","CubeViz_Visualization_HighCharts_Spline"]}return a})(CubeViz_Visualization);var CubeViz_Visualization_HighCharts_Chart=(function(){function a(){}a.prototype.handleTwoDimensionsWithAtLeastOneDimensionElement=function(h,n,j,c,m,k){var p={};var g=0;var o=this;var q=k.getAxesElements(n);_.each(q,function(i){o.chartConfig.xAxis.categories.push(i.self.__cv_niceLabel);p[i.self.__cv_uri]=g++});var b=[];_.each(h,function(i){b.push(i["http://purl.org/linked-data/cube#dimension"])});var f={};var e=k.getAxesElements(j);var l="";var d={};o.chartConfig.series=[];_.each(e,function(i){f={color:CubeViz_Visualization_Controller.getColor(i.self.__cv_uri),data:[],name:i.self.__cv_niceLabel,__cv_uri:i.self.__cv_uri};for(g=0;g<_.size(o.chartConfig.xAxis.categories);++g){f.data.push(null)}_.each(i.observations,function(r){if((false===_.isNull(c)&&(true===_.isNull(r[c])||true===_.isUndefined(r[c])))&&c!==r["http://purl.org/linked-data/cube#attribute"]){return}l="";_.each(b,function(s){l+=r[s]});if(true===_.isUndefined(d[l])){d[l]=true}else{return}if(false===_.isUndefined(r[m])){f.data[p[r[n]]]=parseFloat(r[m])}else{f.data[p[r[n]]]=null}});if(0==_.size(f.data)){}else{o.chartConfig.series.push(f)}})};a.prototype.handleOnlyOneElementDimension=function(d,b,i,f){var j=this;var e=null;var g=[];var c=f.getAxesElements(d);var h=0;this.chartConfig.xAxis.categories=["."];_.each(c,function(k){e=k.observations[_.keys(k.observations)[0]];if(false===_.isNull(b)&&(true===_.isNull(e[b])||true===_.isUndefined(e[b]))){return}j.chartConfig.series.push({name:k.self.__cv_niceLabel,data:[e[i]]})})};a.prototype.handleOnlyOneMultipleDimension=function(h,b,g,d){var i=this;var c=null;var e=[];var j=d.getAxesElements(h);var f=0;_.each(j,function(k){c=k.observations[_.keys(k.observations)[0]];f=DataCube_Observation.parseValue(c[g]);if(false===f){return}if(false===_.isNull(b)&&(true===_.isNull(c[b])||true===_.isUndefined(c[b]))){return}i.chartConfig.xAxis.categories.push(k.self.__cv_niceLabel);e.push(f)});this.chartConfig.series=[{name:".",data:e}]};a.prototype.init=function(g,c,f,j,p,n,b){var l=0;var m=null;var h=null;var e=0;var k=new DataCube_Observation();var o=this;this.chartConfig=g;this.chartConfig.series=[];if(true===_.isUndefined(o.chartConfig.xAxis)){this.chartConfig.xAxis={categories:[]}}else{this.chartConfig.xAxis.categories=[]}this.chartConfig.title.text="";if(true===_.isUndefined(this.chartConfig.xAxis)){this.chartConfig.xAxis={title:{text:""}}}if(true===_.isUndefined(this.chartConfig.yAxis)){this.chartConfig.yAxis={title:{text:""}}}_.each(f,function(i){if(2>_.keys(i.__cv_elements).length){return}if(null==m){m=i["http://purl.org/linked-data/cube#dimension"]}else{h=i["http://purl.org/linked-data/cube#dimension"]}});if(null==h){_.each(f,function(i){if(1==_.keys(i.__cv_elements).length&&null==h){h=i["http://purl.org/linked-data/cube#dimension"]}})}this.chartConfig._cubeVizVisz=this.chartConfig._cubeVizVisz||{};if("true"==this.chartConfig._cubeVizVisz.doSwitchingAxes){var d=m;m=h;h=d}k.initialize(c,f,n);if(false===_.str.isBlank(m)&&false===_.str.isBlank(h)){this.handleTwoDimensionsWithAtLeastOneDimensionElement(f,m,h,b,n,k)}else{if(false===_.str.isBlank(m)||false===_.str.isBlank(h)){if(false===_.str.isBlank(m)){this.handleOnlyOneMultipleDimension(m,b,n,k)}else{this.handleOnlyOneElementDimension(h,b,n,k)}}}return this};a.prototype.getRenderResult=function(){return this.chartConfig};return a})();var CubeViz_Visualization_HighCharts_Area=(function(b){__extends(a,b);function a(){b.apply(this,arguments)}return a})(CubeViz_Visualization_HighCharts_Chart);var CubeViz_Visualization_HighCharts_AreaSpline=(function(a){__extends(b,a);function b(){a.apply(this,arguments)}return b})(CubeViz_Visualization_HighCharts_Chart);var CubeViz_Visualization_HighCharts_Bar=(function(a){__extends(b,a);function b(){a.apply(this,arguments)}return b})(CubeViz_Visualization_HighCharts_Chart);var CubeViz_Visualization_HighCharts_Column=(function(b){__extends(a,b);function a(){b.apply(this,arguments)}return a})(CubeViz_Visualization_HighCharts_Chart);var CubeViz_Visualization_HighCharts_Line=(function(a){__extends(b,a);function b(){a.apply(this,arguments)}return b})(CubeViz_Visualization_HighCharts_Chart);var CubeViz_Visualization_HighCharts_Pie=(function(b){__extends(a,b);function a(){b.apply(this,arguments)}a.prototype.init=function(e,c,d,f,m,j){if(1<_.size(f)){throw new Error("Pie chart is only suitable for one dimension!");return}var k=f[_.keys(f)[0]]["http://purl.org/linked-data/cube#dimension"];var h="";var g=new DataCube_Observation();var l=this;var o=[];var i=0;this.chartConfig=e;this.chartConfig.colors=[];this.chartConfig.series=[];this.chartConfig.title.text="";if(true===_.isUndefined(this.chartConfig.xAxis)){this.chartConfig.xAxis={title:{text:""}}}if(true===_.isUndefined(this.chartConfig.yAxis)){this.chartConfig.yAxis={title:{text:""}}}g.initialize(c,d,j);var n=g.getAxesElements(k);this.chartConfig.series.push({type:"pie",name:this.chartConfig.title.text,data:[]});_.each(n,function(p){_.each(p.observations,function(q){try{i=parseFloat(q[j])}catch(r){return}if(-1==$.inArray(p.self.__cv_niceLabel,o)){l.chartConfig.series[0].data.push([p.self.__cv_niceLabel,i]);l.chartConfig.colors.push(CubeViz_Visualization_Controller.getColor(p.self.__cv_uri));o.push(p.self.__cv_niceLabel)}else{return}})});return this};return a})(CubeViz_Visualization_HighCharts_Chart);var CubeViz_Visualization_HighCharts_Polar=(function(b){__extends(a,b);function a(){b.apply(this,arguments)}return a})(CubeViz_Visualization_HighCharts_Chart);var CubeViz_Visualization_HighCharts_Spline=(function(a){__extends(b,a);function b(){a.apply(this,arguments)}return b})(CubeViz_Visualization_HighCharts_Chart);var DataCube_Component=(function(){function c(){}c.loadAllAttributes=function e(h,j,f,i,g,k){$.ajax({url:h+"getcomponents",data:{serviceUrl:j,modelIri:f,dsdUrl:i,dsUrl:g,componentType:"attribute"}}).error(function(n,l,m){throw new Error("Attribute loadAll: "+n.responseText)}).success(function(l){if(false===_.isUndefined(l)&&false===_.isUndefined(l.content)){k(l.content)}})};c.loadAllDimensions=function b(h,j,f,i,g,k){$.ajax({url:h+"getcomponents",data:{serviceUrl:j,modelIri:f,dsdUrl:i,dsUrl:g,componentType:"dimension"}}).error(function(n,l,m){throw new Error("loadAllDimensions: "+n.responseText)}).success(function(l){if(false===_.isUndefined(l)&&false===_.isUndefined(l.content)){k(l.content)}})};c.loadAllMeasures=function d(h,j,f,i,g,k){$.ajax({url:h+"getcomponents",data:{serviceUrl:j,modelIri:f,dsdUrl:i,dsUrl:g,componentType:"measure"}}).error(function(n,l,m){throw new Error("loadAllMeasures: "+n.responseText)}).done(function(l){if(false===_.isUndefined(l)&&false===_.isUndefined(l.content)){k(l.content)}})};c.getDefaultSelectedDimensions=function a(j){var n=[];var j=JSON.parse(JSON.stringify(j));var l=0;var k=0;var f=0;var g=0;var m=0;var o={};var h={};_.each(j,function(p,i){n=[];k=0;g=_.keys(p.__cv_elements).length;f=1+Math.floor(_.keys(p.__cv_elements).length*0.3);f=10<f?10:1>f?1:f;do{m=Math.floor((Math.random()*g));if(-1===$.inArray(m,n)){if((n.length+1)<=f){n.push(m)}if(f==n.length){break}}k++}while((2*f)>k);h={};l=0;_.each(p.__cv_elements,function(q,r){if(-1<$.inArray(l,n)){h[l]=q}l++});p.__cv_elements=h;o[i]=p});return o};return c})();var DataCube_DataCubeMerger=(function(){function e(){}e.adaptDimensionElements=function k(o,n,m){var l=0;_.each(n,function(p){p["http://www.w3.org/1999/02/22-rdf-syntax-ns#type"]=o+"dimension"+m;p["http://purl.org/dc/terms/source"]=p.__cv_uri;if(false===_.isUndefined(p["http://www.w3.org/2002/07/owl#sameAs"])){p["http://www.w3.org/2002/07/owl#sameAs"]=[p["http://www.w3.org/2002/07/owl#sameAs"],p.__cv_uri]}else{p["http://www.w3.org/2002/07/owl#sameAs"]=p.__cv_uri}p.__cv_uri=o+"dimension"+m+"dimensionElement"+l;p.__cv_hashedUri=CryptoJS.MD5(p.__cv_uri)+"";++l});return n};e.buildDataSets=function h(p,o,n,m,l){return{0:{__cv_niceLabel:"Artifical Dataset","http://www.w3.org/2000/01/rdf-schema#label":"Merged DataSet",__cv_description:"This is an artifical data set and it consists of '"+o+"' and '"+n+"'",__cv_uri:p+"dataset",__cv_hashedUri:CryptoJS.MD5(p+"dataset")+"","http://purl.org/dc/terms/source":[m,l],"http://purl.org/linked-data/cube#structure":p+"dataStructureDefinition","http://www.w3.org/1999/02/22-rdf-syntax-ns#type":"http://purl.org/linked-data/cube#DataSet"}}};e.buildDataStructureDefinitions=function g(o,n){var m={0:{__cv_niceLabel:"Artifical Data Structure Definition","http://www.w3.org/2000/01/rdf-schema#label":"Artifical Data Structure Definition",__cv_description:"This is an artifical data structure definition created during a data cube merge.",__cv_uri:o+"dataStructureDefinition",__cv_hashedUri:CryptoJS.MD5(o+"dataStructureDefinition")+"","http://www.w3.org/1999/02/22-rdf-syntax-ns#type":"http://purl.org/linked-data/cube#DataStructureDefinition","http://purl.org/linked-data/cube#component":{0:o+"measure"}}};var l=1;_.each(n,function(p){m[0]["http://purl.org/linked-data/cube#component"][l]=p.__cv_uri;++l});return m};e.buildDimensionsAndTheirComponentSpecifications=function f(p,o){var l={};var m=0;var n={};_.each(o,function(q){l={__cv_niceLabel:"Merged Component Specification","http://www.w3.org/2000/01/rdf-schema#label":"Merged Component Specification",__cv_description:"This Component Specification was merged and consists of '"+q[0].__cv_niceLabel+"' and '"+q[1].__cv_niceLabel+"'",__cv_uri:p+"componentSpecificationDimension"+m,__cv_hashedUri:CryptoJS.MD5(p+"componentSpecificationDimension"+m)+"","http://www.w3.org/2002/07/owl#sameAs":[q[0].__cv_uri,q[1].__cv_uri],"http://purl.org/dc/terms/source":[q[0].__cv_uri,q[1].__cv_uri],__cv_elements:{},"http://purl.org/linked-data/cube#dimension":p+"dimension"+m,"http://www.w3.org/1999/02/22-rdf-syntax-ns#type":"http://purl.org/linked-data/cube#ComponentSpecification"};l.__cv_elements=e.mergeDimensionElements(q[0].__cv_elements,q[1].__cv_elements);l.__cv_elements=e.adaptDimensionElements(p,l.__cv_elements,m);n[l.__cv_uri]=l;++m});return n};e.buildMeasure=function i(p,m,l,o,n){return{0:{__cv_niceLabel:"Artifical Measure","http://www.w3.org/2000/01/rdf-schema#label":"Artifical Measure",__cv_description:"This is an artifical measure and it consists of '"+o+"' and '"+n+"'",__cv_uri:p+"componentSpecificationMeasure",__cv_hashedUri:CryptoJS.MD5(p+"componentSpecificationMeasure")+"","http://purl.org/linked-data/cube#measure":p+"measure","http://purl.org/dc/terms/source":[m,l],"http://www.w3.org/1999/02/22-rdf-syntax-ns#type":"http://purl.org/linked-data/cube#ComponentSpecification"}}};e.buildRetrievedObservations=function j(t,n,m,s,r,v,u,p){n=$.parseJSON(JSON.stringify(n));m=$.parseJSON(JSON.stringify(m));var l={};var q="";var o=0;_.each(n,function(w){w["http://purl.org/linked-data/cube#dataSet"]=t+"dataset";w[t+"measure"]=w[s];delete w[s];_.each(v.__cv_elements,function(x){if(x["http://purl.org/dc/terms/source"]==w[v["http://purl.org/linked-data/cube#dimension"]]){q=x.__cv_uri}});w[t+"dimension"+p]=q;delete w[v.__cv_uri];l[o++]=w});_.each(m,function(w){w["http://purl.org/linked-data/cube#dataSet"]=t+"dataset";w[t+"measure"]=w[r];delete w[r];_.each(u.__cv_elements,function(x){if(x["http://purl.org/dc/terms/source"]==w[u["http://purl.org/linked-data/cube#dimension"]]){q=x.__cv_uri}});w[t+"dimension"+p]=q;delete w[u["http://purl.org/linked-data/cube#dimension"]];l[o++]=w});return l};e.generateMergedDataCubeUri=function a(l,m){return l+"go/mergeddatacube/"+CryptoJS.MD5(m)+"#"};e.getDefaultDataCubeObject=function c(){return{components:{attributes:null,dimensions:{},measures:{}},dataSets:{},dataStructureDefinitions:{},numberOfMultipleDimensions:0,numberOfOneElementDimensions:0,retrievedObservations:{},selectedComponents:{},selectedDS:{},selectedDSD:{},selectedSlice:{},slices:{}}};e.getSelectedDimensionElements=function b(n){var m=Math.floor((Math.random()*5)+1);var l={};n=$.parseJSON(JSON.stringify(n));_.each(n,function(q){if(m>q.__cv_elements){q.__cv_elements=q.__cv_elements[0]}else{var o=0;var p={};_.each(q.__cv_elements,function(r){if(o<=m){p[o]=r;++o}});q.__cv_elements=p}l[q.__cv_uri]=q});return l};e.mergeDimensionElements=function d(p,o){var n=0;var l={};var m=[];_.each(p,function(q){l[n++]=q;m.push(q.__cv_uri);if(false===_.isUndefined(q["http://www.w3.org/2002/07/owl#sameAs"])){m.push(q["http://www.w3.org/2002/07/owl#sameAs"])}});_.each(o,function(q){if(-1==$.inArray(q.__cv_uri,m)){if(false===_.isUndefined(q["http://www.w3.org/2002/07/owl#sameAs"])&&-1<$.inArray(q["http://www.w3.org/2002/07/owl#sameAs"],m)){return}l[n++]=q;m.push(q.__cv_uri)}});return l};return e})();var DataCube_DataSet=(function(){function a(){}a.loadAll=function b(d,f,c,e,g){$.ajax({url:d+"getdatasets/",data:{serviceUrl:f,modelIri:c,dsdUrl:e}}).error(function(j,h,i){throw new Error("loadAll error: "+j.responseText)}).success(function(h){if(false===_.isUndefined(h)&&false===_.isUndefined(h.content)){g(h.content)}})};return a})();var DataCube_DataStructureDefinition=(function(){function b(){}b.loadAll=function c(e,f,d,g){$.ajax({url:e+"getdatastructuredefinitions/",data:{serviceUrl:f,modelIri:d}}).error(function(j,h,i){throw new Error("loadAll error: "+j.responseText)}).done(function(h){b.prepareLoadedDataStructureDefinitions(h,g)})};b.prepareLoadedDataStructureDefinitions=function a(d,e){d=JSON.parse(d);d.sort(function(g,f){return g.label.toUpperCase().localeCompare(f.label.toUpperCase())});e(d)};return b})();var DataCube_Observation=(function(){function d(){this._axes={}}d.prototype.addAxisEntryPointsTo=function(h,i,f){var g=this;_.each(f,function(k,j){f[j]={value:k,ref:g._axes[j][k]}});this._axes[h][i].push(f)};d.prototype.getAxesElements=function(f){if(false===_.isUndefined(this._axes[f])){return this._axes[f]}else{return{}}};d.getValues=function b(j,h){var f=false;var i=null;var g=[];_.each(j,function(k){i=d.parseValue(k[h]);if(false===i){f=true;return}else{g.push(i)}});return[g,f]};d.prototype.initialize=function(m,f,j){var l={};var i="";var h={};var g=this;var k=0;this._axes={};_.each(m,function(n){k=d.parseValue(n[j]);if(false===k){return}_.each(f,function(o){i=o["http://purl.org/linked-data/cube#dimension"];h=n[i];if(true===_.isUndefined(g._axes[i])){g._axes[i]={}}if(true===_.isUndefined(g._axes[i][h])){l={__cv_uri:h,__cv_niceLabel:h};_.each(o.__cv_elements,function(p){if(p.__cv_uri==h){l=p}});g._axes[i][h]={observations:{},self:l}}g._axes[i][h].observations[n.__cv_uri]=n})});return this};d.loadAll=function e(g,i,f,h,j,k){$.ajax({url:g+"getobservations/",data:{serviceUrl:i,modelIri:f,cv_dataHash:h,datasetUri:j}}).error(function(n,l,m){throw new Error("Observation loadAll error: "+n.responseText)}).done(function(l){k(l.content)})};d.loadNumberOfObservations=function a(g,i,f,h,j){$.ajax({url:g+"getnumberofobservations/",data:{serviceUrl:i,modelIri:f,dsUri:h}}).error(function(m,k,l){throw new Error("Observation loadNumberOfObservations error: "+m.responseText)}).done(function(k){j(k.content)})};d.parseValue=function c(h){var f=null;try{if(true===_.str.include(h," ")){f=parseFloat(h.replace(/ /gi,""))}else{f=parseFloat(h)}if(false===_.isNaN(f)&&_.isFinite(f)){return f}}catch(g){return false}return false};d.prototype.sortAxis=function(f,g){return this};return d})();var DataCube_Slice=(function(){function a(){}a.loadAll=function b(e,g,c,f,d,h){$.ajax({url:e+"getslices",data:{serviceUrl:g,modelIri:c,dsdUrl:f,dsUrl:d}}).error(function(k,i,j){throw new Error("DataCube_Slice > loadAll: "+k.responseText)}).success(function(i){if(false===_.isUndefined(i)&&false===_.isUndefined(i.content)){h(i.content)}})};return a})();var View_CompareAction_ModelSelection=(function(a){__extends(b,a);function b(c,d){a.call(this,"View_CompareAction_ModelSelection",c,d);this.bindGlobalEvents([{name:"onStart_application",handler:this.onStart_application}])}b.prototype.destroy=function(){a.prototype.destroy.call(this);return this};b.prototype.handleModelSelectorChanges=function(d){var c=_.str.trim($("#cubeviz-compare-modelSelector"+d+" option:selected").text());var e=$("#cubeviz-compare-modelSelector"+d).val();if(""!=e){this.app._.compareAction.models[d]={__cv_compareNr:d,__cv_uri:e,__cv_niceLabel:c};this.triggerGlobalEvent("onSelect_model"+d);if(""!=this.app._.compareAction.models[1]&&""!=this.app._.compareAction.models[2]){this.triggerGlobalEvent("onSelect_model1AndModel2")}}else{this.app._.compareAction.models[d]=null;this.triggerGlobalEvent("onSelect_noModel"+d)}};b.prototype.initialize=function(){this.collection.reset("__cv_uri");this.render()};b.prototype.onChange_modelSelector1=function(){this.handleModelSelectorChanges("1")};b.prototype.onChange_modelSelector2=function(){this.handleModelSelectorChanges("2")};b.prototype.onStart_application=function(){this.initialize()};b.prototype.render=function(){this.bindUserInterfaceEvents({"change #cubeviz-compare-modelSelector1":this.onChange_modelSelector1,"change #cubeviz-compare-modelSelector2":this.onChange_modelSelector2});return this};return b})(CubeViz_View_Abstract);var View_CompareAction_DatasetSelection=(function(b){__extends(a,b);function a(c,d){b.call(this,"View_CompareAction_DatasetSelection",c,d);this.bindGlobalEvents([{name:"onReceive_datasets",handler:this.onReceive_datasets},{name:"onReceive_noDatasets",handler:this.onReceive_noDatasets},{name:"onSelect_model1",handler:this.onSelect_model1},{name:"onSelect_model2",handler:this.onSelect_model2},{name:"onSelect_noModel1",handler:this.onSelect_noModel1},{name:"onSelect_noModel2",handler:this.onSelect_noModel2},{name:"onStart_application",handler:this.onStart_application}])}a.prototype.destroy=function(){b.prototype.destroy.call(this);return this};a.prototype.fillSelectBox=function(c,e){var d={};$(c).html('<option value="">- please select -</option>');_.each(e,function(f){d=$("<option/>");d.attr("value",f.__cv_uri).data("self",f).text(f.__cv_niceLabel);$(c).append(d)})};a.prototype.initialize=function(){this.collection.reset("__cv_uri");this.render()};a.prototype.handleDatasetSelectorChanges=function(c,d){var e=$("#cubeviz-compare-datasetSelector"+c).val();if(true===_.str.isBlank(e)){this.app._.compareAction.datasets[c]=null;this.triggerGlobalEvent("onSelected_noDataset"+c)}else{d.__cv_compareNr=c;this.app._.compareAction.datasets[c]=d;this.triggerGlobalEvent("onSelected_dataset"+c)}if(false===_.isNull(this.app._.compareAction.datasets[1])&&false===_.isNull(this.app._.compareAction.datasets[2])){this.triggerGlobalEvent("onSelected_dataset1AndDataset2")}};a.prototype.handleModelSelectorChanges=function(d){var c=this;$("#cubeviz-compare-datasetSelectionDiv"+d).show();$("#cubeviz-compare-datasetSelector"+d).html('<option value="">please wait ... </option>');DataCube_DataSet.loadAll(this.app._.backend.url,"",this.app._.compareAction.models[d].__cv_uri,"",function(e){c.onReceive_datasets(e,d)})};a.prototype.onReceive_datasets=function(c,e){var d=this;$("#cubeviz-compare-datasetSelectorWarningBox"+e).hide();if(0<_.size(c)){d.fillSelectBox("#cubeviz-compare-datasetSelector"+e,c)}else{$("#cubeviz-compare-datasetSelector"+e).html('<option value="">Choose another model ... </option>');d.triggerGlobalEvent("onReceive_noDatasets",{modelNr:e,modelUri:d.app._.compareAction.models[e].__cv_uri})}};a.prototype.onReceive_noDatasets=function(c,d){$("#cubeviz-compare-datasetSelectorWarningBox"+d.modelNr).show()};a.prototype.onSelect_dataset1=function(c){this.handleDatasetSelectorChanges("1",$(c.target).find("option:selected").data("self"))};a.prototype.onSelect_dataset2=function(c){this.handleDatasetSelectorChanges("2",$(c.target).find("option:selected").data("self"))};a.prototype.onSelect_model1=function(c,d){this.handleModelSelectorChanges("1")};a.prototype.onSelect_model2=function(c,d){this.handleModelSelectorChanges("2")};a.prototype.onSelect_noModel1=function(){$("#cubeviz-compare-datasetSelectionDiv1").hide()};a.prototype.onSelect_noModel2=function(){$("#cubeviz-compare-datasetSelectionDiv2").hide()};a.prototype.onStart_application=function(){this.initialize()};a.prototype.render=function(){this.bindUserInterfaceEvents({"change #cubeviz-compare-datasetSelector1":this.onSelect_dataset1,"change #cubeviz-compare-datasetSelector2":this.onSelect_dataset2});return this};return a})(CubeViz_View_Abstract);var View_CompareAction_GeneralDatasetInformation=(function(b){__extends(a,b);function a(c,d){b.call(this,"View_CompareAction_GeneralDatasetInformation",c,d);this.bindGlobalEvents([{name:"onReceived_attributes1AndAttributes2",handler:this.onReceived_attributes1AndAttributes2},{name:"onReceived_dimensions1AndDimensions2",handler:this.onReceived_dimensions1AndDimensions2},{name:"onReceived_measures1AndMeasures2",handler:this.onReceived_measures1AndMeasures2},{name:"onReceived_numbersOfObservations1AndNumbersOfObservations2",handler:this.onReceived_numbersOfObservations1AndNumbersOfObservations2},{name:"onReceived_slices1AndSlices2",handler:this.onReceived_slices1AndSlices2},{name:"onSelected_dataset1",handler:this.onSelected_dataset1},{name:"onSelected_dataset2",handler:this.onSelected_dataset2},{name:"onStart_application",handler:this.onStart_application}])}a.prototype.destroy=function(){b.prototype.destroy.call(this);return this};a.prototype.displayAttributesInformation1=function(){var c=$("#cubeviz-compare-generalDatasetInformation1").find(".cubeviz-compare-informationPieceBox");$($(c.get(3)).find(".cubeviz-compare-informationPieceBoxValue").first()).html(_.size(this.app._.compareAction.components.attributes[1]));$("#cubeviz-compare-generalDatasetInformation1").show()};a.prototype.displayAttributesInformation2=function(){var c=$("#cubeviz-compare-generalDatasetInformation2").find(".cubeviz-compare-informationPieceBox");$($(c.get(3)).find(".cubeviz-compare-informationPieceBoxValue").first()).html(_.size(this.app._.compareAction.components.attributes[2]));$("#cubeviz-compare-generalDatasetInformation2").show()};a.prototype.displayDimensionsInformation1=function(){var c=$("#cubeviz-compare-generalDatasetInformation1").find(".cubeviz-compare-informationPieceBox");$($(c.get(0)).find(".cubeviz-compare-informationPieceBoxValue").first()).html(_.size(this.app._.compareAction.components.dimensions[1]));$("#cubeviz-compare-generalDatasetInformation1").show()};a.prototype.displayDimensionsInformation2=function(){var c=$("#cubeviz-compare-generalDatasetInformation2").find(".cubeviz-compare-informationPieceBox");$($(c.get(0)).find(".cubeviz-compare-informationPieceBoxValue").first()).html(_.size(this.app._.compareAction.components.dimensions[2]));$("#cubeviz-compare-generalDatasetInformation2").show()};a.prototype.displayDimensionElementsInformation1=function(){var e=$("#cubeviz-compare-generalDatasetInformation1").find(".cubeviz-compare-informationPieceBox");var c=0;var d=this;_.each(this.app._.compareAction.components.dimensions[1],function(f){c+=_.size(f.__cv_elements)});$($(e.get(1)).find(".cubeviz-compare-informationPieceBoxValue").first()).html(c);$("#cubeviz-compare-generalDatasetInformation1").show()};a.prototype.displayDimensionElementsInformation2=function(){var e=$("#cubeviz-compare-generalDatasetInformation2").find(".cubeviz-compare-informationPieceBox");var c=0;var d=this;_.each(this.app._.compareAction.components.dimensions[2],function(f){_.each(f.__cv_elements,function(g){++c})});$($(e.get(1)).find(".cubeviz-compare-informationPieceBoxValue").first()).html(c);$("#cubeviz-compare-generalDatasetInformation1").show()};a.prototype.displayMeasuresInformation1=function(){var c=$("#cubeviz-compare-generalDatasetInformation1").find(".cubeviz-compare-informationPieceBox");$($(c.get(2)).find(".cubeviz-compare-informationPieceBoxValue").first()).html(_.size(this.app._.compareAction.components.measures[1]));$("#cubeviz-compare-generalDatasetInformation1").show()};a.prototype.displayMeasuresInformation2=function(){var c=$("#cubeviz-compare-generalDatasetInformation2").find(".cubeviz-compare-informationPieceBox");$($(c.get(2)).find(".cubeviz-compare-informationPieceBoxValue").first()).html(_.size(this.app._.compareAction.components.measures[2]));$("#cubeviz-compare-generalDatasetInformation2").show()};a.prototype.displayNumberOfObservations1=function(){var c=$("#cubeviz-compare-generalDatasetInformation1").find(".cubeviz-compare-informationPieceBox");$($(c.get(5)).find(".cubeviz-compare-informationPieceBoxValue").first()).html(this.app._.compareAction.numberOfObservations[1]);$("#cubeviz-compare-generalDatasetInformation1").show()};a.prototype.displayNumberOfObservations2=function(){var c=$("#cubeviz-compare-generalDatasetInformation2").find(".cubeviz-compare-informationPieceBox");$($(c.get(5)).find(".cubeviz-compare-informationPieceBoxValue").first()).html(this.app._.compareAction.numberOfObservations[2]);$("#cubeviz-compare-generalDatasetInformation2").show()};a.prototype.displaySlicesInformation1=function(){var c=$("#cubeviz-compare-generalDatasetInformation1").find(".cubeviz-compare-informationPieceBox");$($(c.get(4)).find(".cubeviz-compare-informationPieceBoxValue").first()).html(_.size(this.app._.compareAction.slices[1]));$("#cubeviz-compare-generalDatasetInformation1").show()};a.prototype.displaySlicesInformation2=function(){var c=$("#cubeviz-compare-generalDatasetInformation2").find(".cubeviz-compare-informationPieceBox");$($(c.get(4)).find(".cubeviz-compare-informationPieceBoxValue").first()).html(_.size(this.app._.compareAction.slices[2]));$("#cubeviz-compare-generalDatasetInformation2").show()};a.prototype.initialize=function(){this.collection.reset("__cv_uri");this.render()};a.prototype.handleDatasetSelectorChanges=function(d){var c=this;this.app._.compareAction.components.dimensions[d]=null;this.app._.compareAction.components.measures[d]=null;this.app._.compareAction.components.attributes[d]=null;DataCube_Component.loadAllDimensions(this.app._.backend.url,"",this.app._.compareAction.models[d].__cv_uri,this.app._.compareAction.datasets[d]["http://purl.org/linked-data/cube#structure"],this.app._.compareAction.datasets[d].__cv_uri,function(e){c.app._.compareAction.components.dimensions[d]=e;c.triggerGlobalEvent("onReceived_dimensions"+d);if(false===_.isNull(c.app._.compareAction.components.dimensions[1])&&false===_.isNull(c.app._.compareAction.components.dimensions[2])){c.triggerGlobalEvent("onReceived_dimensions1AndDimensions2")}});DataCube_Component.loadAllMeasures(this.app._.backend.url,"",this.app._.compareAction.models[d].__cv_uri,this.app._.compareAction.datasets[d]["http://purl.org/linked-data/cube#structure"],this.app._.compareAction.datasets[d].__cv_uri,function(e){c.app._.compareAction.components.measures[d]=e;c.triggerGlobalEvent("onReceived_measures"+d);if(false===_.isNull(c.app._.compareAction.components.measures[1])&&false===_.isNull(c.app._.compareAction.components.measures[2])){c.triggerGlobalEvent("onReceived_measures1AndMeasures2")}});DataCube_Component.loadAllAttributes(this.app._.backend.url,"",this.app._.compareAction.models[d].__cv_uri,this.app._.compareAction.datasets[d]["http://purl.org/linked-data/cube#structure"],this.app._.compareAction.datasets[d].__cv_uri,function(e){c.app._.compareAction.components.attributes[d]=e;c.triggerGlobalEvent("onReceived_attributes"+d);if(false===_.isNull(c.app._.compareAction.components.measures[1])&&false===_.isNull(c.app._.compareAction.components.measures[2])){c.triggerGlobalEvent("onReceived_attributes1AndAttributes2")}});DataCube_Slice.loadAll(this.app._.backend.url,"",this.app._.compareAction.models[d].__cv_uri,this.app._.compareAction.datasets[d]["http://purl.org/linked-data/cube#structure"],this.app._.compareAction.datasets[d].__cv_uri,function(e){c.app._.compareAction.slices[d]=e;c.triggerGlobalEvent("onReceived_slices"+d);if(false===_.isNull(c.app._.compareAction.slices[1])&&false===_.isNull(c.app._.compareAction.slices[2])){c.triggerGlobalEvent("onReceived_slices1AndSlices2")}});DataCube_Observation.loadNumberOfObservations(this.app._.backend.url,"",this.app._.compareAction.models[d].__cv_uri,this.app._.compareAction.datasets[d].__cv_uri,function(e){c.app._.compareAction.numberOfObservations[d]=e;c.triggerGlobalEvent("onReceived_observationNumber"+d);if(-1<c.app._.compareAction.numberOfObservations[1]&&-1<c.app._.compareAction.numberOfObservations[2]){c.triggerGlobalEvent("onReceived_numbersOfObservations1AndNumbersOfObservations2")}});DataCube_Observation.loadAll(this.app._.backend.url,"",this.app._.compareAction.models[d].__cv_uri,"",this.app._.compareAction.datasets[d].__cv_uri,function(e){c.app._.compareAction.retrievedObservations[d]=e;c.triggerGlobalEvent("onReceived_observations"+d);if(false==_.isNull(c.app._.compareAction.retrievedObservations[1])&&false==_.isNull(c.app._.compareAction.retrievedObservations[2])){c.triggerGlobalEvent("onReceived_observations1AndObservations2")}})};a.prototype.onSelected_dataset1=function(c){this.handleDatasetSelectorChanges("1")};a.prototype.onSelected_dataset2=function(c){this.handleDatasetSelectorChanges("2")};a.prototype.onReceived_attributes1AndAttributes2=function(){this.displayAttributesInformation1();this.displayAttributesInformation2()};a.prototype.onReceived_dimensions1AndDimensions2=function(){this.displayDimensionsInformation1();this.displayDimensionsInformation2();this.displayDimensionElementsInformation1();this.displayDimensionElementsInformation2()};a.prototype.onReceived_measures1AndMeasures2=function(){this.displayMeasuresInformation1();this.displayMeasuresInformation2()};a.prototype.onReceived_numbersOfObservations1AndNumbersOfObservations2=function(){this.displayNumberOfObservations1();this.displayNumberOfObservations2()};a.prototype.onReceived_slices1AndSlices2=function(){this.displaySlicesInformation1();this.displaySlicesInformation2()};a.prototype.onStart_application=function(){this.initialize()};a.prototype.render=function(){this.bindUserInterfaceEvents({});return this};return a})(CubeViz_View_Abstract);var View_CompareAction_DimensionOverview=(function(b){__extends(a,b);function a(c,d){b.call(this,"View_CompareAction_DimensionOverview",c,d);this.bindGlobalEvents([{name:"onReceived_dimensions1AndDimensions2",handler:this.onReceived_dimensions1AndDimensions2},{name:"onStart_application",handler:this.onStart_application}])}a.prototype.destroy=function(){b.prototype.destroy.call(this);return this};a.prototype.displayEqualDimensions=function(){var j="";var g=null;var f=null;var d=0;var e=0;var h=2000;var c=this;if(0<_.size(this.app._.compareAction.equalDimensions)){$("#cubeviz-compare-equalDimensions1").show();$("#cubeviz-compare-equalDimensions2").show();$("#cubeviz-compare-equalDimensionsTableContainer1").html("");$("#cubeviz-compare-equalDimensionsTableContainer2").html("");_.each(this.app._.compareAction.equalDimensions,function(i){j=i[0].__cv_description;if(true===_.str.isBlank(j)){j="no description found"}g=$(CubeViz_View_Helper.tplReplace($("#cubeviz-compare-tpl-equalDimension").html(),{dimensionLabel:i[0].__cv_niceLabel,dimensionDescription:j}));if(false===_.isUndefined(i[0].__cv_equalElements)&&0<_.size(i[0].__cv_equalElements)){f=$($(g).find(".cubeviz-compare-dimensionTitleAndElements").first());f.append($('<td rowspan="3" style="vertical-align: middle;"><div style="-webkit-transform:rotate(-90deg);">Dimension Elements</div></td>'));_.each(i[0].__cv_equalElements,function(k){f.append($('<td rowspan="3" style="vertical-align: middle;"><div style="-webkit-transform:rotate(-90deg);">'+k.__cv_niceLabel+"</div></td>"))});$($(g).find(".cubeviz-compare-dimensionNumberOfUnequalDimensionElements").first()).html(_.size(i[0].__cv_elements)-_.size(i[0].__cv_equalElements));$($(g).find(".cubeviz-compare-dimensionNumberOfEqualDimensionElements").first()).html(_.size(i[0].__cv_equalElements))}$("#cubeviz-compare-equalDimensionsTableContainer1").append(g);j=i[1].__cv_description;if(true===_.str.isBlank(j)){j="no description found"}g=$(CubeViz_View_Helper.tplReplace($("#cubeviz-compare-tpl-equalDimension").html(),{dimensionLabel:i[1].__cv_niceLabel,dimensionDescription:j}));if(false===_.isUndefined(i[1].__cv_equalElements)&&0<_.size(i[1].__cv_equalElements)){f=$($(g).find(".cubeviz-compare-dimensionTitleAndElements").first());f.append($('<td rowspan="3" style="vertical-align: middle;"><div style="-webkit-transform:rotate(-90deg);">Dimension Elements</div></td>'));_.each(i[1].__cv_equalElements,function(k){f.append($('<td rowspan="3" style="vertical-align: middle;"><div style="-webkit-transform:rotate(-90deg);">'+k.__cv_niceLabel+"</div></td>"))});$($(g).find(".cubeviz-compare-dimensionNumberOfUnequalDimensionElements").first()).html(_.size(i[1].__cv_elements)-_.size(i[1].__cv_equalElements));$($(g).find(".cubeviz-compare-dimensionNumberOfEqualDimensionElements").first()).html(_.size(i[1].__cv_equalElements))}$("#cubeviz-compare-equalDimensionsTableContainer2").append(g);h+=1000});$("#cubeviz-compare-equalDimensionsTableContainer1").width(h);$("#cubeviz-compare-equalDimensionsTableContainer2").width(h)}};a.prototype.displayUnequalDimensions=function(){var d=null;var c="";$("#cubeviz-compare-unequalDimensionsTableContainer1").html("");if(0<_.size(this.app._.compareAction.unequalDimensions[1])||0<_.size(this.app._.compareAction.unequalDimensions[2])){$("#cubeviz-compare-unequalDimensions1").show();$("#cubeviz-compare-unequalDimensions2").show()}_.each(this.app._.compareAction.unequalDimensions[1],function(e){c=e.__cv_description;if(true===_.str.isBlank(c)){c="no description found"}d=$(CubeViz_View_Helper.tplReplace($("#cubeviz-compare-tpl-unequalDimension").html(),{dimensionLabel:e.__cv_niceLabel,dimensionDescription:c}));$(d.find(".cubeviz-compare-numberOfDimensionElements").first()).html(_.size(e.__cv_elements));$("#cubeviz-compare-unequalDimensionsTableContainer1").append(d)});_.each(this.app._.compareAction.unequalDimensions[2],function(e){c=e.__cv_description;if(true===_.str.isBlank(c)){c="no description found"}d=$(CubeViz_View_Helper.tplReplace($("#cubeviz-compare-tpl-unequalDimension").html(),{dimensionLabel:e.__cv_niceLabel,dimensionDescription:c}));$(d.find(".cubeviz-compare-numberOfDimensionElements").first()).html(_.size(e.__cv_elements));$("#cubeviz-compare-unequalDimensionsTableContainer2").append(d)})};a.prototype.findEqualDimensions=function(){var g=null;var e=null;var d=this;var f={};var c=[];d.app._.compareAction.equalDimensions=[];d.app._.compareAction.unequalDimensions={1:[],2:[]};_.each(this.app._.compareAction.components.dimensions[1],function(h){f[h.__cv_uri]=h.__cv_uri;if(false===_.str.isBlank(h["http://www.w3.org/2002/07/owl#sameAs"])){f[h["http://www.w3.org/2002/07/owl#sameAs"]]=h.__cv_uri}});_.each(this.app._.compareAction.components.dimensions[2],function(h){if(false===_.isUndefined(f[h.__cv_uri])||false===_.isUndefined(f[h["http://www.w3.org/2002/07/owl#sameAs"]])){if(false===_.isUndefined(f[h.__cv_uri])){e=d.app._.compareAction.components.dimensions[1][f[h.__cv_uri]]}else{e=d.app._.compareAction.components.dimensions[1][f[h["http://www.w3.org/2002/07/owl#sameAs"]]]}g=d.findEqualDimensionElements(e,h);e.__cv_equalElements=g[1];h.__cv_equalElements=g[2];d.app._.compareAction.equalDimensions.push([e,h]);c.push(e.__cv_uri)}else{d.app._.compareAction.unequalDimensions[2].push(h)}});_.each(this.app._.compareAction.components.dimensions[1],function(h){if(-1===$.inArray(h.__cv_uri,c)){d.app._.compareAction.unequalDimensions[1].push(h)}});if(0<_.size(this.app._.compareAction.equalDimensions)){this.triggerGlobalEvent("onFound_equalDimensions")}};a.prototype.findEqualDimensionElements=function(e,d){var c={1:[],2:[]};var f={};if(0==_.size(e.__cv_elements)||0==_.size(d.__cv_elements)){return c}_.each(e.__cv_elements,function(g){f[g.__cv_uri]=g;if(false===_.str.isBlank(g["http://www.w3.org/2002/07/owl#sameAs"])){f[g["http://www.w3.org/2002/07/owl#sameAs"]]=g}});_.each(d.__cv_elements,function(g){if(false===_.isUndefined(f[g.__cv_uri])){c[1].push(f[g.__cv_uri]);c[2].push(g)}if(false===_.isUndefined(f[g["http://www.w3.org/2002/07/owl#sameAs"]])){c[1].push(f[g["http://www.w3.org/2002/07/owl#sameAs"]]);c[2].push(g)}});return c};a.prototype.onReceived_dimensions1AndDimensions2=function(c){this.findEqualDimensions();this.displayUnequalDimensions();this.displayEqualDimensions()};a.prototype.onStart_application=function(){this.initialize()};a.prototype.render=function(){this.bindUserInterfaceEvents({});return this};return a})(CubeViz_View_Abstract);var View_CompareAction_MeasureAndAttributeInformation=(function(a){__extends(b,a);function b(c,d){a.call(this,"View_CompareAction_MeasureAndAttributeInformation",c,d);this._measures1And2Recveived=false;this._observations1And2Received=false;this.bindGlobalEvents([{name:"onReceived_measures1AndMeasures2",handler:this.onReceived_measures1AndMeasures2},{name:"onReceived_observations1AndObservations2",handler:this.onReceived_observations1AndObservations2},{name:"onStart_application",handler:this.onStart_application}])}b.prototype.destroy=function(){a.prototype.destroy.call(this);return this};b.prototype.displayMeasuresAndAttributesInformation=function(e){var h=$("#cubeviz-compare-measuresAndAttributesInformation"+e);var f=false;var g=this.app._.compareAction.components.measures[e][Object.keys(this.app._.compareAction.components.measures[e])[0]];var c=null;var d=null;d=DataCube_Observation.getValues(this.app._.compareAction.retrievedObservations[e],g["http://purl.org/linked-data/cube#measure"]);c=d[0];f=d[1];if(true===f){$("#cubeviz-compare-mAAInvalidNumbersFound"+e).show()}$(h.find(".cubeviz-compare-mAARangeMin").first()).html(true===f?"~ "+String(jsStats.min(c)).substring(0,10):String(jsStats.min(c)).substring(0,10));$(h.find(".cubeviz-compare-mAARangeMax").first()).html(true===f?"~ "+String(jsStats.max(c)).substring(0,10):String(jsStats.max(c)).substring(0,10));$(h.find(".cubeviz-compare-mAAMedian").first()).html(true===f?"~ "+String(jsStats.median(c)).substring(0,10):String(jsStats.median(c)).substring(0,10));$(h.find(".cubeviz-compare-mAAMean").first()).html(true===f?"~ "+String(jsStats.mean(c)).substring(0,10):String(jsStats.mean(c)).substring(0,10));$(h.find(".cubeviz-compare-mAAVariance").first()).html(true===f?"~ "+String(jsStats.variance(c)).substring(0,10):String(jsStats.variance(c)).substring(0,10));$(h.find(".cubeviz-compare-mAAStandardDeviation").first()).html(true===f?"~ "+String(jsStats.standardDeviation(c)).substring(0,10):String(jsStats.standardDeviation(c)).substring(0,10));$("#cubeviz-compare-measuresAndAttributesInformation"+e).show()};b.prototype.initialize=function(){this.collection.reset("__cv_uri");this.render()};b.prototype.onReceived_measures1AndMeasures2=function(){this._measures1And2Recveived=true;if(true===this._measures1And2Recveived&&true===this._observations1And2Received){this.displayMeasuresAndAttributesInformation(1);this.displayMeasuresAndAttributesInformation(2)}};b.prototype.onReceived_observations1AndObservations2=function(){this._observations1And2Received=true;if(true===this._measures1And2Recveived&&true===this._observations1And2Received){this.displayMeasuresAndAttributesInformation(1);this.displayMeasuresAndAttributesInformation(2)}};b.prototype.onStart_application=function(){this.initialize()};b.prototype.render=function(){this.bindUserInterfaceEvents({});return this};return b})(CubeViz_View_Abstract);var View_CompareAction_VisualizationSetup=(function(a){__extends(b,a);function b(c,d){a.call(this,"View_CompareAction_VisualizationSetup",c,d);this._equalDimensionsFound=false;this._measuresReceived=false;this._observationsReceived=false;this.bindGlobalEvents([{name:"onFound_equalDimensions",handler:this.onFound_equalDimensions},{name:"onReceived_measures1AndMeasures2",handler:this.onReceived_measures1AndMeasures2},{name:"onReceived_observations1AndObservations2",handler:this.onReceived_observations1AndObservations2},{name:"onStart_application",handler:this.onStart_application}])}b.prototype.checkAndCreateMergedDataCube=function(){if(false===this._equalDimensionsFound||false===this._measuresReceived||false===this._observationsReceived){return}var e="";var h=null;var g=null;var c={};var i="";var d=this;var f=[];c=DataCube_DataCubeMerger.getDefaultDataCubeObject();i=DataCube_DataCubeMerger.generateMergedDataCubeUri(this.app._.backend.url,JSON.stringify(this.app._.compareAction));c.dataSets=DataCube_DataCubeMerger.buildDataSets(i,this.app._.compareAction.datasets[1].__cv_niceLabel,this.app._.compareAction.datasets[2].__cv_niceLabel,this.app._.compareAction.datasets[1].__cv_uri,this.app._.compareAction.datasets[2].__cv_uri);c.selectedDS=c.dataSets[0];c.components.dimensions=DataCube_DataCubeMerger.buildDimensionsAndTheirComponentSpecifications(i,this.app._.compareAction.equalDimensions);c.selectedComponents.dimensions=c.components.dimensions;h=this.app._.compareAction.components.measures[1][Object.keys(this.app._.compareAction.components.measures[1])[0]];g=this.app._.compareAction.components.measures[2][Object.keys(this.app._.compareAction.components.measures[2])[0]];c.components.measures=DataCube_DataCubeMerger.buildMeasure(i,h.__cv_uri,g.__cv_uri,h.__cv_niceLabel,g.__cv_niceLabel);c.selectedComponents.measure=c.components.measures[0];c.dataStructureDefinitions=DataCube_DataCubeMerger.buildDataStructureDefinitions(i,c.components.dimensions);c.selectedDSD=c.dataStructureDefinitions[0];if(1==_.size(this.app._.compareAction.equalDimensions)){c.retrievedObservations=DataCube_DataCubeMerger.buildRetrievedObservations(i,this.app._.compareAction.retrievedObservations[1],this.app._.compareAction.retrievedObservations[2],h["http://purl.org/linked-data/cube#measure"],g["http://purl.org/linked-data/cube#measure"],this.app._.compareAction.equalDimensions[0][0],this.app._.compareAction.equalDimensions[0][1],0)}else{if(2==_.size(this.app._.compareAction.equalDimensions)){}else{if(2<_.size(this.app._.compareAction.equalDimensions)){}else{c=null}}}console.log("");console.log("mergedDataCube for "+_.size(this.app._.compareAction.equalDimensions)+" equal dimensions:");console.log("");console.log(c);CubeViz_ConfigurationLink.save(this.app._.backend.url,this.app._.backend.modelUrl,c,"data",function(k){console.log("");console.log("generated hash: "+k);var j=d.app._.backend.url+"?";if(false===_.isNull(d.app._.backend.serviceUrl)){j+="serviceUrl="+encodeURIComponent(d.app._.backend.serviceUrl)+"&"}if(true===_.str.isBlank(d.app._.backend.modelUrl)){j+="m="+encodeURIComponent(d.app._.compareAction.models[1].__cv_uri)}else{j+="m="+encodeURIComponent(d.app._.backend.modelUrl)}j+="&cv_dataHash="+k;$("#cubeviz-compare-visualizeLink").attr("href",j).show()},true)};b.prototype.destroy=function(){a.prototype.destroy.call(this);return this};b.prototype.initialize=function(){this.collection.reset("__cv_uri");this.render()};b.prototype.onFound_equalDimensions=function(){this._equalDimensionsFound=true;this.checkAndCreateMergedDataCube()};b.prototype.onReceived_measures1AndMeasures2=function(){this._measuresReceived=true;this.checkAndCreateMergedDataCube()};b.prototype.onReceived_observations1AndObservations2=function(){this._observationsReceived=true;this.checkAndCreateMergedDataCube()};b.prototype.onStart_application=function(){this.initialize()};b.prototype.render=function(){this.bindUserInterfaceEvents({});return this};return b})(CubeViz_View_Abstract);var View_DataselectionModule_DataSet=(function(b){__extends(a,b);function a(c,d){b.call(this,"View_CubeVizModule_DataSet",c,d);this.bindGlobalEvents([{name:"onStart_application",handler:this.onStart_application}])}a.prototype.destroy=function(){b.prototype.destroy.call(this);CubeViz_View_Helper.destroyDialog($("#cubeviz-dataSet-dialog"));return this};a.prototype.initialize=function(){this.collection.reset("__cv_uri");this.collection.addList(this.app._.data.dataSets);this.render()};a.prototype.onClick_closeAndUpdate=function(h){var f=$(h.target).data("dialogDiv");var e=new CubeViz_Collection("__cv_uri");var g=$("input[name=cubeviz-dataSelectionModule-dataSetRadio]:checked").val();var c=null;var d=this;CubeViz_View_Helper.showCloseAndUpdateSpinner(f);CubeViz_View_Helper.showLeftSidebarSpinner();c=e.addList(this.app._.data.dataSets).get(g);this.app._.data.selectedDS=c;CubeViz_View_Helper.hideCloseAndUpdateSpinner(f);CubeViz_View_Helper.closeDialog(f);$("#cubeviz-dataSet-label").html(_.str.prune(c.__cv_niceLabel,24,".."));this.app._.data.retrievedObservations={};_.each(this.app._.data.dataStructureDefinitions,function(j){if(j.__cv_uri==c["http://purl.org/linked-data/cube#structure"]){d.app._.data.selectedDSD=j}});var i={callback:function(){d.triggerGlobalEvent("onReRender_visualization")}};this.triggerGlobalEvent("onChange_selectedDS",i)};a.prototype.onClick_dialogOpener=function(e){var d=$($("#cubeviz-dataSelectionModule-dialog-dataSet").find(".cubeviz-dataSelectionModule-dialogElements").get(0)).children();var c=this;_.each(d,function(f){if(c.app._.data.selectedDS.__cv_uri==$($(f).children().first()).val()){$($(f).children().first()).attr("checked",true)}});CubeViz_View_Helper.openDialog($("#cubeviz-dataSelectionModule-dialog-dataSet"))};a.prototype.onClick_questionmark=function(d){$("#cubeviz-dataSelectionModule-dialogContainer").append(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-helpDialog").html(),{__cv_id:"dataSet",__cv_niceLabel:$("#cubeviz-dataSelectionModule-tra-dataSetHelpDialogTitle").html(),__cv_description:$("#cubeviz-dataSelectionModule-tra-dataSetHelpDialogDescription").html()}));var c=$("#cubeviz-dataSelectionModule-helpDialog-dataSet");CubeViz_View_Helper.attachDialogTo(c,{closeOnEscape:true,showCross:true,width:500});CubeViz_View_Helper.openDialog(c)};a.prototype.onStart_application=function(){this.initialize()};a.prototype.render=function(){this.triggerGlobalEvent("onBeforeRender_dataSet");$("#cubeviz-dataSet-label").html(_.str.prune(this.app._.data.selectedDS.__cv_niceLabel,24,"..")).attr("title",this.app._.data.selectedDS.__cv_niceLabel);if(1===_.size(this.app._.data.dataSets)){$("#cubeviz-dataSet-dialogOpener").hide()}else{$("#cubeviz-dataSelectionModule-dialogContainer").append(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-dialog").html(),{__cv_niceLabel:$("#cubeviz-dataSelectionModule-tra-dataSetHelpDialogTitle").html(),__cv_hashedUri:"dataSet",__cv_description:"",__cv_shortDescription:$("#cubeviz-dataSelectionModule-tra-dataSetHelpDialogDescription").html(),__cv_title:""}));var f=$("#cubeviz-dataSelectionModule-dialog-dataSet");CubeViz_View_Helper.attachDialogTo(f,{closeOnEscape:true,showCross:true,width:650});$(f.find(".cubeviz-dataSelectionModule-dialog-description").get(0)).hide();$(f.find(".cubeviz-dataSelectionModule-dialogSortButtons").get(0)).hide();$(f.find(".cubeviz-dataSelectionModule-selectAllButton").get(0)).hide();$(f.find(".cubeviz-dataSelectionModule-deselectButton").get(0)).hide();$("#cubeviz-dataSet-dialogOpener").data("dialogDiv",f);$($(f.find(".cubeviz-dataSelectionModule-cancelBtn")).get(0)).data("dialogDiv",f);$($(f.find(".cubeviz-dataSelectionModule-closeAndUpdateBtn")).get(0)).data("dialogDiv",f).on("click",$.proxy(this.onClick_closeAndUpdate,this));$($(f.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(0)).data("dialogDiv",f).data("type","alphabet");$($(f.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(1)).hide();$($(f.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(2)).hide();var e=new CubeViz_Collection("__cv_uri");var d=null;var c=$(f.find(".cubeviz-dataSelectionModule-dialogElements")[0]);e.addList(this.app._.data.dataSets).sortAscendingBy("__cv_niceLabel").each(function(g){d=$(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-dialogRadioElement").html(),{__cv_niceLabel:g.__cv_niceLabel,__cv_uri:g.__cv_uri,radioCSSClass:"cubeviz-dataSelectionModule-dataSetRadio",radioName:"cubeviz-dataSelectionModule-dataSetRadio",radioValue:g.__cv_uri}));c.append(d)});this.bindUserInterfaceEvents({"click #cubeviz-dataSet-dialogOpener":this.onClick_dialogOpener});$("#cubeviz-dataSet-dialogOpener").show()}this.triggerGlobalEvent("onAfterRender_dataSet");this.bindUserInterfaceEvents({"click #cubeviz-dataSet-questionmark":this.onClick_questionmark});return this};return a})(CubeViz_View_Abstract);var View_DataselectionModule_Slice=(function(b){__extends(a,b);function a(c,d){b.call(this,"View_CubeVizModule_Slice",c,d);this.bindGlobalEvents([{name:"onChange_selectedDS",handler:this.onChange_selectedDS},{name:"onStart_application",handler:this.onStart_application}])}a.prototype.destroy=function(){b.prototype.destroy.call(this);return this};a.prototype.initialize=function(){this.collection.reset("__cv_uri");this.collection.addList(this.app._.data.slices);this.render()};a.prototype.onChange_selectedDS=function(){var c=this;DataCube_Slice.loadAll(this.app._.backend.url,this.app._.backend.serviceUrl,this.app._.backend.modelUrl,this.app._.data.selectedDSD.__cv_uri,this.app._.data.selectedDS.__cv_uri,function(d){c.app._.data.slices=d;if(0===_.keys(d).length){}else{c.app._.data.selectedSlice={}}})};a.prototype.onClick_closeAndUpdate=function(f){var e=$(f.target).data("dialogDiv");var h=new CubeViz_Collection("__cv_uri");var c=$("input[name=cubeviz-dataSelectionModule-sliceRadio]:checked").val();var d=this;CubeViz_View_Helper.showCloseAndUpdateSpinner(e);if("noSlice"==c){this.app._.data.selectedSlice={};$("#cubeviz-slice-label").html(_.str.prune($("#cubeviz-dataSelectionModule-tra-sliceNoSelection").html(),24,".."))}else{this.app._.data.selectedSlice=h.addList(this.app._.data.slices).get(c);$("#cubeviz-slice-label").html(_.str.prune(this.app._.data.selectedSlice.__cv_niceLabel,24,".."))}CubeViz_View_Helper.hideCloseAndUpdateSpinner(e);CubeViz_View_Helper.closeDialog(e);var g={callback:function(){d.triggerGlobalEvent("onReRender_visualization")}};this.triggerGlobalEvent("onChange_selectedSlice",g)};a.prototype.onClick_dialogOpener=function(c){CubeViz_View_Helper.openDialog($("#cubeviz-dataSelectionModule-dialog-slice"))};a.prototype.onClick_questionmark=function(d){$("#cubeviz-dataSelectionModule-dialogContainer").append(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-helpDialog").html(),{__cv_id:"slice",__cv_niceLabel:$("#cubeviz-dataSelectionModule-tra-sliceHelpDialogTitle").html(),__cv_description:$("#cubeviz-dataSelectionModule-tra-sliceHelpDialogDescription").html()}));var c=$("#cubeviz-dataSelectionModule-helpDialog-slice");CubeViz_View_Helper.attachDialogTo(c,{closeOnEscape:true,showCross:true,width:500});CubeViz_View_Helper.openDialog(c)};a.prototype.onStart_application=function(){this.initialize()};a.prototype.render=function(){this.triggerGlobalEvent("onBeforeRender_slice");var d="";var h="";var c=this;if(0===_.size(this.app._.data.slices)){$("#cubeviz-dataSelectionModule-sliceBlock").hide()}else{$("#cubeviz-dataSelectionModule-sliceBlock").show();if(0===_.keys(this.app._.data.selectedSlice).length){d=$("#cubeviz-dataSelectionModule-tra-sliceNoSelection").html()}else{d=this.app._.data.selectedComponents.attribute.__cv_niceLabel;h=this.app._.data.selectedComponents.attribute.__cv_description}$("#cubeviz-dataSelectionModule-dialogContainer").append(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-dialog").html(),{__cv_niceLabel:$("#cubeviz-dataSelectionModule-tra-sliceDialogTitle").html(),__cv_hashedUri:"slice",__cv_description:"",__cv_shortDescription:$("#cubeviz-dataSelectionModule-tra-sliceDialogDescription").html(),__cv_title:""}));var g=$("#cubeviz-dataSelectionModule-dialog-slice");CubeViz_View_Helper.attachDialogTo(g,{closeOnEscape:true,showCross:true,width:650});$(g.find(".cubeviz-dataSelectionModule-dialogSortButtons").get(0)).hide();$(g.find(".cubeviz-dataSelectionModule-selectAllButton").get(0)).hide();$(g.find(".cubeviz-dataSelectionModule-deselectButton").get(0)).hide();$("#cubeviz-slice-dialogOpener").data("dialogDiv",g);$($(g.find(".cubeviz-dataSelectionModule-cancelBtn")).get(0)).data("dialogDiv",g);$($(g.find(".cubeviz-dataSelectionModule-closeAndUpdateBtn")).get(0)).data("dialogDiv",g).on("click",$.proxy(this.onClick_closeAndUpdate,this));$($(g.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(0)).data("dialogDiv",g).data("type","alphabet");$($(g.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(1)).hide();$($(g.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(2)).hide();var f=null;var e=$(g.find(".cubeviz-dataSelectionModule-dialogElements")[0]);f=$(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-dialogRadioElement").html(),{__cv_niceLabel:$("#cubeviz-dataSelectionModule-tra-sliceDialogNoSliceSelectionElement").html(),__cv_uri:"__cv_noSlice",radioCSSClass:"cubeviz-dataSelectionModule-sliceRadio",radioName:"cubeviz-dataSelectionModule-sliceRadio",radioValue:"noSlice"}));if(0===_.size(this.app._.data.selectedSlice)){$(f.children().first()).attr("checked",true)}$(f.children().last()).css("font-weight","bold");e.append(f);this.collection.sortAscendingBy("__cv_niceLabel").each(function(i){f=$(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-dialogRadioElement").html(),{__cv_niceLabel:i.__cv_niceLabel,__cv_uri:i.__cv_uri,radioCSSClass:"cubeviz-dataSelectionModule-sliceRadio",radioName:"cubeviz-dataSelectionModule-sliceRadio",radioValue:i.__cv_uri}));if(i.__cv_uri==c.app._.data.selectedSlice.__cv_uri){$(f.children().first()).attr("checked",true)}e.append(f)});this.bindUserInterfaceEvents({"click #cubeviz-slice-dialogOpener":this.onClick_dialogOpener})}$("#cubeviz-slice-label").html(_.str.prune(d,24,"..")).attr("title",d);$("#cubeviz-slice-description").html(_.str.prune(h,55,"..")).attr("title",h);this.triggerGlobalEvent("onAfterRender_slice");this.bindUserInterfaceEvents({"click #cubeviz-slice-questionmark":this.onClick_questionmark});return this};return a})(CubeViz_View_Abstract);var View_DataselectionModule_Measure=(function(b){__extends(a,b);function a(c,d){b.call(this,"View_CubeVizModule_Measure",c,d);this.bindGlobalEvents([{name:"onChange_selectedDS",handler:this.onChange_selectedDS},{name:"onStart_application",handler:this.onStart_application}])}a.prototype.destroy=function(){b.prototype.destroy.call(this);CubeViz_View_Helper.destroyDialog($("#cubeviz-measure-dialog"));return this};a.prototype.initialize=function(){this.collection.reset("__cv_uri");this.collection.addList(this.app._.data.components.measures);this.render()};a.prototype.onChange_selectedDS=function(d){var c=this;DataCube_Component.loadAllMeasures(this.app._.backend.url,this.app._.backend.serviceUrl,this.app._.backend.modelUrl,this.app._.data.selectedDSD.__cv_uri,this.app._.data.selectedDS.__cv_uri,function(e){c.app._.data.components.measures=e;if(0===_.keys(e).length){throw new Error("Error: There are no measures in the selected data set!")}else{c.app._.data.selectedComponents.measure=e[_.keys(e)[0]]}})};a.prototype.onClick_closeAndUpdate=function(g){var f=$(g.target).data("dialogDiv");var h=new CubeViz_Collection("__cv_uri");var e=$("input[name=cubeviz-dataSelectionModule-measureRadio]:checked").val();var c=null;var d=this;CubeViz_View_Helper.showCloseAndUpdateSpinner(f);CubeViz_View_Helper.showLeftSidebarSpinner();c=h.addList(this.app._.data.components.measures).get(e);this.app._.data.selectedComponents.measure=c;CubeViz_View_Helper.hideCloseAndUpdateSpinner(f);CubeViz_View_Helper.closeDialog(f);$("#cubeviz-measure-label").html(_.str.prune(c.__cv_niceLabel,24,".."));CubeViz_ConfigurationLink.save(this.app._.backend.url,this.app._.backend.modelUrl,this.app._.data,"data",function(i){DataCube_Observation.loadAll(d.app._.backend.url,d.app._.backend.serviceUrl,d.app._.backend.modelUrl,i,"",function(j){d.app._.data.retrievedObservations=j;d.triggerGlobalEvent("onChange_selectedMeasure");d.triggerGlobalEvent("onReRender_visualization");CubeViz_View_Helper.hideLeftSidebarSpinner()});d.app._.backend.dataHash=i})};a.prototype.onClick_dialogOpener=function(e){var d=$($("#cubeviz-dataSelectionModule-dialog-measure").find(".cubeviz-dataSelectionModule-dialogElements").get(0)).children();var c=this;if(1==d.length){$($(d.first()).children().first()).attr("checked",true)}else{_.each(d,function(f){if(c.app._.data.selectedComponents.measure.__cv_uri==$($(f).children().first()).val()){$($(f).children().first()).attr("checked",true)}})}CubeViz_View_Helper.openDialog($("#cubeviz-dataSelectionModule-dialog-measure"))};a.prototype.onStart_application=function(){this.initialize()};a.prototype.render=function(){this.triggerGlobalEvent("onBeforeRender_measure");$("#cubeviz-measure-label").html(_.str.prune(this.app._.data.selectedComponents.measure.__cv_niceLabel,24,"..")).attr("title",this.app._.data.selectedComponents.measure.__cv_niceLabel);$("#cubeviz-measure-description").html(_.str.prune(this.app._.data.selectedComponents.measure.__cv_description,55,"..")).attr("title",this.app._.data.selectedComponents.measure.__cv_description);if(1==_.keys(this.app._.data.components.measures).length){$("#cubeviz-measure-dialogOpener").hide()}else{$("#cubeviz-dataSelectionModule-dialogContainer").append(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-dialog").html(),{__cv_niceLabel:$("#cubeviz-dataSelectionModule-tra-measureDialogTitle").html(),__cv_hashedUri:"measure",__cv_description:"",__cv_shortDescription:$("#cubeviz-dataSelectionModule-tra-measureDialogDescription").html(),__cv_title:""}));var e=$("#cubeviz-dataSelectionModule-dialog-measure");CubeViz_View_Helper.attachDialogTo(e,{closeOnEscape:true,showCross:true,width:650});$(e.find(".cubeviz-dataSelectionModule-dialog-description").get(0)).hide();$(e.find(".cubeviz-dataSelectionModule-dialogSortButtons").get(0)).hide();$(e.find(".cubeviz-dataSelectionModule-selectAllButton").get(0)).hide();$(e.find(".cubeviz-dataSelectionModule-deselectButton").get(0)).hide();$("#cubeviz-measure-dialogOpener").data("dialogDiv",e);$($(e.find(".cubeviz-dataSelectionModule-cancelBtn")).get(0)).data("dialogDiv",e);$($(e.find(".cubeviz-dataSelectionModule-closeAndUpdateBtn")).get(0)).data("dialogDiv",e).on("click",$.proxy(this.onClick_closeAndUpdate,this));$($(e.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(0)).data("dialogDiv",e).data("type","alphabet");$($(e.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(1)).hide();$($(e.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(2)).hide();var f=new CubeViz_Collection("__cv_uri");var d=null;var c=$(e.find(".cubeviz-dataSelectionModule-dialogElements")[0]);f.addList(this.app._.data.components.measures).sortAscendingBy("__cv_niceLabel").each(function(g){d=$(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-dialogRadioElement").html(),{__cv_niceLabel:g.__cv_niceLabel,__cv_uri:g.__cv_uri,radioCSSClass:"cubeviz-dataSelectionModule-measureRadio",radioName:"cubeviz-dataSelectionModule-measureRadio",radioValue:g.__cv_uri}));c.append(d)});this.bindUserInterfaceEvents({"click #cubeviz-measure-dialogOpener":this.onClick_dialogOpener})}this.triggerGlobalEvent("onAfterRender_measure");return this};return a})(CubeViz_View_Abstract);var View_DataselectionModule_Attribute=(function(a){__extends(b,a);function b(c,d){a.call(this,"View_CubeVizModule_Attribute",c,d);this.bindGlobalEvents([{name:"onChange_selectedDS",handler:this.onChange_selectedDS},{name:"onStart_application",handler:this.onStart_application}])}b.prototype.destroy=function(){a.prototype.destroy.call(this);$("#cubeviz-attribute-dialogOpener").off();CubeViz_View_Helper.destroyDialog($("#cubeviz-dataSelectionModule-dialog-attribute"));$("#cubeviz-dataSelectionModule-dialog-attribute").remove();return this};b.prototype.initialize=function(){this.collection.reset("__cv_uri");this.collection.addList(this.app._.data.components.attributes);this.render()};b.prototype.onChange_selectedDS=function(d){var c=this;DataCube_Component.loadAllAttributes(this.app._.backend.url,this.app._.backend.serviceUrl,this.app._.backend.modelUrl,this.app._.data.selectedDSD.__cv_uri,this.app._.data.selectedDS.__cv_uri,function(e){c.app._.data.components.attributes=e;if(0===_.keys(e).length){}else{c.app._.data.selectedComponents.attribute=e[_.keys(e)[0]]}c.destroy().initialize()})};b.prototype.onClick_closeAndUpdate=function(h){var g=$(h.target).data("dialogDiv");var f=new CubeViz_Collection("__cv_uri");var c=$("input[name=cubeviz-dataSelectionModule-attributeRadio]:checked").val();var d=null;var e=this;CubeViz_View_Helper.showCloseAndUpdateSpinner(g);CubeViz_View_Helper.showLeftSidebarSpinner();if("noAttribute"==c){this.app._.data.selectedComponents.attribute=null;$("#cubeviz-attribute-label").html(_.str.prune($("#cubeviz-dataSelectionModule-tra-attributeDialogNoAttributeSelectedLabel").html(),24,"..")).attr("title",$("#cubeviz-dataSelectionModule-tra-attributeDialogNoAttributeSelectedLabel").html());$("#cubeviz-attribute-description").html(_.str.prune($("#cubeviz-dataSelectionModule-tra-attributeDialogNoAttributeSelectedDescription").html(),55,"..")).attr("title",$("#cubeviz-dataSelectionModule-tra-attributeDialogNoAttributeSelectedDescription").html())}else{d=f.addList(this.app._.data.components.attributes).get(c);this.app._.data.selectedComponents.attribute=d;$("#cubeviz-attribute-label").html(_.str.prune(d.__cv_niceLabel,24,".."))}CubeViz_View_Helper.hideCloseAndUpdateSpinner(g);CubeViz_View_Helper.closeDialog(g);CubeViz_ConfigurationLink.save(this.app._.backend.url,this.app._.backend.modelUrl,this.app._.data,"data",function(i){DataCube_Observation.loadAll(e.app._.backend.url,e.app._.backend.serviceUrl,e.app._.backend.modelUrl,i,"",function(j){e.app._.data.retrievedObservations=j;e.triggerGlobalEvent("onChange_selectedAttribute");e.triggerGlobalEvent("onReRender_visualization");CubeViz_View_Helper.hideLeftSidebarSpinner()});e.app._.backend.dataHash=i})};b.prototype.onClick_dialogOpener=function(e){var d=$($("#cubeviz-dataSelectionModule-dialog-attribute").find(".cubeviz-dataSelectionModule-dialogElements").get(0)).children();var c=this;if(false===_.isUndefined(this.app._.data.selectedComponents.attribute)&&false===_.isNull(this.app._.data.selectedComponents.attribute)){_.each(d,function(f){if(c.app._.data.selectedComponents.attribute.__cv_uri==$($(f).children().first()).val()){$($(f).children().first()).attr("checked",true)}})}CubeViz_View_Helper.openDialog($("#cubeviz-dataSelectionModule-dialog-attribute"))};b.prototype.onClick_questionmark=function(d){$("#cubeviz-dataSelectionModule-dialogContainer").append(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-helpDialog").html(),{__cv_id:"attributeAndMeasure",__cv_niceLabel:$("#cubeviz-dataSelectionModule-tra-attributeAndMeasureHelpDialogTitle").html(),__cv_description:$("#cubeviz-dataSelectionModule-tra-attributeAndMeasureHelpDialogDescription").html()}));var c=$("#cubeviz-dataSelectionModule-helpDialog-attributeAndMeasure");CubeViz_View_Helper.attachDialogTo(c,{closeOnEscape:true,showCross:true,width:500});CubeViz_View_Helper.openDialog(c)};b.prototype.onStart_application=function(){this.initialize()};b.prototype.render=function(){this.triggerGlobalEvent("onBeforeRender_attribute");var i=false;var c="";var g="";if(0===_.size(this.app._.data.components.attributes)){c="[no attribute found]";i=true;$("#cubeviz-dataSelectionModule-attributeBlock").hide()}else{if(0<_.size(this.app._.data.components.attributes)&&(true===_.isUndefined(this.app._.data.selectedComponents.attribute)||true===_.isNull(this.app._.data.selectedComponents.attribute))){c=$("#cubeviz-dataSelectionModule-tra-attributeDialogNoAttributeSelectedLabel").html();g=$("#cubeviz-dataSelectionModule-tra-attributeDialogNoAttributeSelectedDescription").html()}else{c=this.app._.data.selectedComponents.attribute.__cv_niceLabel;g=this.app._.data.selectedComponents.attribute.__cv_description}}$("#cubeviz-attribute-label").html(_.str.prune(c,24,"..")).attr("title",c);$("#cubeviz-attribute-description").html(_.str.prune(g,55,"..")).attr("title",g);if(false===i){if(0==_.size(this.app._.data.components.attributes)){$("#cubeviz-attribute-dialogOpener").hide()}else{$("#cubeviz-dataSelectionModule-dialogContainer").append(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-dialog").html(),{__cv_niceLabel:$("#cubeviz-dataSelectionModule-tra-attributeDialogTitle").html(),__cv_hashedUri:"attribute",__cv_description:"",__cv_shortDescription:$("#cubeviz-dataSelectionModule-tra-attributeDialogDescription").html(),__cv_title:""}));var f=$("#cubeviz-dataSelectionModule-dialog-attribute");CubeViz_View_Helper.attachDialogTo(f,{closeOnEscape:true,showCross:true,width:650});$(f.find(".cubeviz-dataSelectionModule-dialog-description").get(0)).hide();$(f.find(".cubeviz-dataSelectionModule-dialogSortButtons").get(0)).hide();$(f.find(".cubeviz-dataSelectionModule-selectAllButton").get(0)).hide();$(f.find(".cubeviz-dataSelectionModule-deselectButton").get(0)).hide();$("#cubeviz-attribute-dialogOpener").data("dialogDiv",f);$($(f.find(".cubeviz-dataSelectionModule-cancelBtn")).get(0)).data("dialogDiv",f);$($(f.find(".cubeviz-dataSelectionModule-closeAndUpdateBtn")).get(0)).data("dialogDiv",f).on("click",$.proxy(this.onClick_closeAndUpdate,this));$($(f.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(0)).data("dialogDiv",f).data("type","alphabet");$($(f.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(1)).hide();$($(f.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(2)).hide();var h=new CubeViz_Collection("__cv_uri");var e=null;var d=$(f.find(".cubeviz-dataSelectionModule-dialogElements")[0]);e=$(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-dialogRadioElement").html(),{__cv_niceLabel:$("#cubeviz-dataSelectionModule-tra-sliceDialogNoSliceSelectionElement").html(),__cv_uri:"__cv_noAttribute",radioCSSClass:"cubeviz-dataSelectionModule-attributeRadio",radioName:"cubeviz-dataSelectionModule-attributeRadio",radioValue:"noAttribute"}));$(e.children().last()).css("font-weight","bold");if(true===_.isUndefined(this.app._.data.selectedComponents.attribute)||true===_.isNull(this.app._.data.selectedComponents.attribute)){$(e.children().first()).attr("checked",true)}d.append(e);h.addList(this.app._.data.components.attributes).sortAscendingBy("__cv_niceLabel").each(function(j){e=$(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-dialogRadioElement").html(),{__cv_niceLabel:j.__cv_niceLabel,__cv_uri:j.__cv_uri,radioCSSClass:"cubeviz-dataSelectionModule-attributeRadio",radioName:"cubeviz-dataSelectionModule-attributeRadio",radioValue:j.__cv_uri}));d.append(e)});this.bindUserInterfaceEvents({"click #cubeviz-attribute-dialogOpener":this.onClick_dialogOpener});$("#cubeviz-attribute-dialogOpener").show()}}else{$("#cubeviz-attribute-dialogOpener").hide()}this.triggerGlobalEvent("onAfterRender_attribute");this.bindUserInterfaceEvents({"click #cubeviz-attributeAndMeasure-questionmark":this.onClick_questionmark});return this};return b})(CubeViz_View_Abstract);var View_DataselectionModule_Component=(function(b){__extends(a,b);function a(c,d){b.call(this,"View_CubeVizModule_Component",c,d);this.bindGlobalEvents([{name:"onStart_application",handler:this.onStart_application},{name:"onChange_selectedDS",handler:this.onChange_selectedDS},{name:"onChange_selectedSlice",handler:this.onChange_selectedSlice}])}a.prototype.configureSetupComponentDialog=function(d,g,f){var c=this;$("#cubeviz-dataSelectionModule-dialogContainer").append(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-dialog").html(),{__cv_niceLabel:d.__cv_niceLabel,__cv_hashedUri:d.__cv_hashedUri,__cv_description:d.__cv_description,__cv_shortDescription:$("#cubeviz-dataSelectionModule-tra-componentDialogDescription").html(),__cv_title:$("#cubeviz-dataSelectionModule-tra-componentDialogMainTitle").html()}));var e=$("#cubeviz-dataSelectionModule-dialog-"+d.__cv_hashedUri);if(true==_.str.isBlank(d.__cv_description)){$(e.find(".cubeviz-dataSelectionModule-dialog-description").get(0)).hide()}e.data("componentBox",g).data("component",d);CubeViz_View_Helper.attachDialogTo(e);$(e.find(".cubeviz-dataSelectionModule-selectAllButton").get(0)).data("dialogDiv",e);$(e.find(".cubeviz-dataSelectionModule-deselectButton").get(0)).data("dialogDiv",e);f.data("dialogDiv",e);$($(e.find(".cubeviz-dataSelectionModule-cancelBtn")).get(0)).data("dialogDiv",e);$($(e.find(".cubeviz-dataSelectionModule-closeAndUpdateBtn")).get(0)).data("dialogDiv",e).on("click",$.proxy(this.onClick_closeAndUpdate,this));$($(e.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(0)).data("dialogDiv",e).data("type","alphabet");$($(e.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(1)).data("dialogDiv",e).data("type","check status");$($(e.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(2)).data("dialogDiv",e).data("type","observation count");this.configureSetupComponentElements(d)};a.prototype.configureSetupComponentElements=function(k){var f=null;var j=$("#cubeviz-dataSelectionModule-dialog-"+k.__cv_hashedUri);var i={};var h=new CubeViz_Collection("__cv_uri");var g=$(j.find(".cubeviz-dataSelectionModule-dialogElements")[0]);var e=this.app._.data.selectedComponents.dimensions[k.__cv_uri].__cv_elements;var l=this;var d=null;var c=false;h.addList(k.__cv_elements).sortAscendingBy("__cv_niceLabel").each(function(m){d=undefined!==_.find(e,function(n){return false===_.isUndefined(n)?n.__cv_uri==m.__cv_uri:false});if(true===d){c=true}i=$(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-dialogCheckboxElement").html(),{__cv_niceLabel:m.__cv_niceLabel,__cv_uri:m.__cv_uri,__cv_uri2:m.__cv_uri}));f=i.children().first();if(true==d){f.attr("checked",true)}$(f).on("click",$.proxy(l.onClick_dimensionElementCheckbox,l));i.data("data",m).data("dialogDiv",j);g.append(i)})};a.prototype.destroy=function(){_.each(this.collection._,function(c){$("#cubeviz-dataSelectionModule-dialog-"+c.__cv_hashedUri).dialog("destroy");$("#cubeviz-dataSelectionModule-dialog-"+c.__cv_hashedUri).remove()});b.prototype.destroy.call(this);CubeViz_View_Helper.destroyDialog($("#cubeviz-component-dialog"));return this};a.prototype.initialize=function(){this.collection.reset("__cv_hashedUri");this.collection.addList(this.app._.data.components.dimensions);this.render()};a.prototype.loadComponentDimensions=function(d){var c=this;DataCube_Component.loadAllDimensions(this.app._.backend.url,this.app._.backend.serviceUrl,this.app._.backend.modelUrl,this.app._.data.selectedDSD.__cv_uri,this.app._.data.selectedDS.__cv_uri,function(e){c.app._.data.components.dimensions=e;c.app._.data.selectedComponents.dimensions=DataCube_Component.getDefaultSelectedDimensions(e);c.collection.reset("__cv_hashedUri").addList(e);d()})};a.prototype.onChange_selectedDS=function(d,e){var c=this;this.destroy();this.loadComponentDimensions(function(){CubeViz_ConfigurationLink.save(c.app._.backend.url,c.app._.backend.modelUrl,c.app._.data,"data",function(f){c.app._.backend.dataHash=f;c.render();CubeViz_ConfigurationLink.save(c.app._.backend.url,c.app._.backend.modelUrl,c.app._.data,"data",function(g){DataCube_Observation.loadAll(c.app._.backend.url,c.app._.backend.serviceUrl,c.app._.backend.modelUrl,g,"",function(h){c.app._.data.retrievedObservations=h;CubeViz_View_Helper.hideLeftSidebarSpinner();e.callback()});c.app._.backend.dataHash=g})})})};a.prototype.onChange_selectedSlice=function(g,h){if(0===_.size(this.app._.data.selectedSlice)){}else{var i=null;var f=null;var e="";var c="";var d=this;_.each(this.app._.data.components.dimensions,function(j){e=j["http://purl.org/linked-data/cube#dimension"];c=d.app._.data.selectedSlice[e];if(false===_.str.isBlank(c)){_.each(j.__cv_elements,function(k){if(k.__cv_uri==c){d.app._.data.selectedComponents.dimensions[j.__cv_uri].__cv_elements={0:k}}})}});this.app._.data.numberOfMultipleDimensions=_.size(CubeViz_Visualization_Controller.getMultipleDimensions(this.app._.data.selectedComponents.dimensions));this.app._.data.numberOfOneElementDimensions=_.size(CubeViz_Visualization_Controller.getOneElementDimensions(this.app._.data.selectedComponents.dimensions));this.destroy().initialize();this.loadComponentDimensions(function(){CubeViz_ConfigurationLink.save(d.app._.backend.url,d.app._.backend.modelUrl,d.app._.data,"data",function(j){d.app._.backend.dataHash=j;d.render();CubeViz_ConfigurationLink.save(d.app._.backend.url,d.app._.backend.modelUrl,d.app._.data,"data",function(k){DataCube_Observation.loadAll(d.app._.backend.url,d.app._.backend.serviceUrl,d.app._.backend.modelUrl,k,"",function(l){d.app._.data.retrievedObservations=l;CubeViz_View_Helper.hideLeftSidebarSpinner();h.callback()});d.app._.backend.dataHash=k})})})}};a.prototype.onClick_cancel=function(c){CubeViz_View_Helper.closeDialog($(c.target).data("dialogDiv"))};a.prototype.onClick_dimensionElementCheckbox=function(e){var f=$(e.target);var h=$($(e.target).parent());var d=h.data("dialogDiv").find('[type="checkbox"]');var c=false;var g=$(h.data("dialogDiv")).data("component").__cv_selectedElementCount;if(1<g||1==this.app._.data.numberOfMultipleDimensions){return}_.each(d,function(i){if($(i).attr("checked")){c=true}});if(false==c){_.each(d,function(i){$(i).attr("disabled",false)});$(h.data("dialogDiv").find(".cubeviz-dataSelectionModule-selectAllButton").get(0)).show();$(h.data("dialogDiv").find(".cubeviz-dataSelectionModule-deselectButton").get(0)).show()}else{_.each(d,function(i){if(!$(i).attr("checked")){$(i).attr("disabled",true)}});$(h.data("dialogDiv").find(".cubeviz-dataSelectionModule-selectAllButton").get(0)).hide();$(h.data("dialogDiv").find(".cubeviz-dataSelectionModule-deselectButton").get(0)).hide()}};a.prototype.onClick_closeAndUpdate=function(e){var d=$(e.target).data("dialogDiv");var c=this;CubeViz_View_Helper.showCloseAndUpdateSpinner(d);this.readAndSaveSetupComponentDialogChanges(d,function(){if(true===cubeVizApp._.backend.uiParts.index.isLoaded){c.triggerGlobalEvent("onReRender_visualization")}c.triggerGlobalEvent("onUpdate_componentDimensions");CubeViz_View_Helper.hideCloseAndUpdateSpinner(d);CubeViz_View_Helper.closeDialog(d)})};a.prototype.onClick_deselectButton=function(c){$(c.target).data("dialogDiv").find('[type="checkbox"]').attr("checked",false)};a.prototype.onClick_selectAllButton=function(c){$(c.target).data("dialogDiv").find('[type="checkbox"]').attr("checked",true)};a.prototype.onClick_setupComponentOpener=function(c){this.triggerGlobalEvent("onClick_setupComponentOpener");var e=$($(c.target).data("dialogDiv")).data("component").__cv_selectedElementCount;var d=$(c.target).data("dialogDiv").find('[type="checkbox"]');if(1==e&&2==this.app._.data.numberOfMultipleDimensions&&2<_.size(this.app._.data.components.dimensions)){_.each(d,function(f){if(!$(f).attr("checked")){$(f).attr("disabled",true)}});$($(c.target).data("dialogDiv").find(".cubeviz-dataSelectionModule-selectAllButton").get(0)).hide();$($(c.target).data("dialogDiv").find(".cubeviz-dataSelectionModule-deselectButton").get(0)).hide()}else{_.each(d,function(f){$(f).attr("disabled",false)});$($(c.target).data("dialogDiv").find(".cubeviz-dataSelectionModule-selectAllButton").get(0)).show();$($(c.target).data("dialogDiv").find(".cubeviz-dataSelectionModule-deselectButton").get(0)).show()}CubeViz_View_Helper.openDialog($(c.target).data("dialogDiv"))};a.prototype.onClick_sortButton=function(e){var d=$(e.target).data("dialogDiv");if(true===_.isUndefined(d)){return}var h=d.data("dimensionTypeUrl");var g=$(d.find(".cubeviz-dataSelectionModule-dialogElements").first());var f=g.children("li");var c=[];$(e.target).data("dialogDiv").find(".cubeviz-component-sortButton").removeClass("cubeviz-dataSelectionModule-dialogSortButtonSelected");$(e.target).addClass("cubeviz-dataSelectionModule-dialogSortButtonSelected");switch($(e.target).data("type")){case"alphabet":c=CubeViz_View_Helper.sortLiItemsByAlphabet(f);break;case"check status":c=CubeViz_View_Helper.sortLiItemsByCheckStatus(f);break;case"observation count":c=CubeViz_View_Helper.sortLiItemsByObservationCount(f,h,this.app._.data.retrievedObservations);break;default:return}g.empty();_.each(c,function(i){g.append(i)})};a.prototype.onClick_questionmark=function(d){$("#cubeviz-dataSelectionModule-dialogContainer").append(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-helpDialog").html(),{__cv_id:"component",__cv_niceLabel:$("#cubeviz-dataSelectionModule-tra-componentHelpDialogTitle").html(),__cv_description:$("#cubeviz-dataSelectionModule-tra-componentHelpDialogDescription").html()}));var c=$("#cubeviz-dataSelectionModule-helpDialog-component");CubeViz_View_Helper.attachDialogTo(c,{closeOnEscape:true,showCross:true,width:500});CubeViz_View_Helper.openDialog(c)};a.prototype.readAndSaveSetupComponentDialogChanges=function(g,j){var f=g.find(".cubeviz-dataSelectionModule-dialogElements").children();var c=g.data("componentBox");var h=g.data("component");var i=null;var d=null;var e=new CubeViz_Collection("__cv_uri");var k=this;if(undefined===h){return}_.each(f,function(l){i=$($(l).children().get(0));d=$($(l).children().get(1));if("checked"===i.attr("checked")){e.add($(l).data("data"))}});this.app._.data.selectedComponents.dimensions[h.__cv_uri].__cv_elements=e.toObject();$(c.find(".cubeviz-component-selectedCount").get(0)).html(e.size());g.data("component").__cv_selectedElementCount=e.size();this.app._.data.numberOfMultipleDimensions=_.size(CubeViz_Visualization_Controller.getMultipleDimensions(this.app._.data.selectedComponents.dimensions));this.app._.data.numberOfOneElementDimensions=_.size(CubeViz_Visualization_Controller.getOneElementDimensions(this.app._.data.selectedComponents.dimensions));CubeViz_ConfigurationLink.save(this.app._.backend.url,this.app._.backend.modelUrl,this.app._.data,"data",function(l){DataCube_Observation.loadAll(k.app._.backend.url,k.app._.backend.serviceUrl,k.app._.backend.modelUrl,l,"",function(m){k.app._.data.retrievedObservations=m;j()});k.app._.backend.dataHash=l})};a.prototype.onComplete_loadDS=function(c,d){this.onChange_selectedDS(c,d)};a.prototype.onComplete_loadObservations=function(d,c){this.app._.data.retrievedObservations=c};a.prototype.onStart_application=function(){this.initialize()};a.prototype.render=function(){this.triggerGlobalEvent("onBeforeRender_component");var e=this.collection._;var h=$("#cubviz-component-listBox");var i=null;var c=this.app._.data.selectedComponents.dimensions;var f=null;var d=this;var g=null;this.collection.reset();_.each(e,function(j){if(false===_.isUndefined(c)){f=c[j.__cv_uri];j.__cv_selectedElementCount=_.keys(f.__cv_elements).length}else{j.__cv_selectedElementCount=1}j.__cv_elementCount=_.size(j.__cv_elements);j.__cv_shortLabel=_.str.prune(j.__cv_niceLabel,23,"..");j.__cv_shortDescription=_.str.prune(j.__cv_description,38,"..");i=$(CubeViz_View_Helper.tplReplace($("#cubeviz-component-tpl-listBoxItem").html(),j));if(1===j.__cv_elementCount){$(i.find(".cubeviz-component-setupComponentOpener").get(0)).hide();$(i.find(".cubeviz-component-selectedElementsBlock").get(0)).hide()}$(i.find(".cubeviz-component-setupComponentOpener").get(0)).data("dimension",j);h.append(i);d.configureSetupComponentDialog(j,i,$(i.find(".cubeviz-component-setupComponentOpener").get(0)));$(i.find(".cubeviz-component-selectedCount").get(0)).html(j.__cv_selectedElementCount);d.collection.add(j)});this.bindUserInterfaceEvents({"click .cubeviz-component-setupComponentOpener":this.onClick_setupComponentOpener,"click #cubeviz-component-questionmark":this.onClick_questionmark,"click .cubeviz-dataSelectionModule-cancelBtn":this.onClick_cancel,"click .cubeviz-dataSelectionModule-deselectButton":this.onClick_deselectButton,"click .cubeviz-dataSelectionModule-selectAllButton":this.onClick_selectAllButton,"click .cubeviz-dataSelectionModule-dialogSortButtons":this.onClick_sortButton});this.triggerGlobalEvent("onAfterRender_component");return this};return a})(CubeViz_View_Abstract);var View_DataselectionModule_Footer=(function(a){__extends(b,a);function b(c,d){a.call(this,"View_CubeVizModule_Footer",c,d);this.bindGlobalEvents([{name:"onAfterChange_selectedDSD",handler:this.onAfterChange_selectedDSD},{name:"onBeforeClick_selectorItem",handler:this.onBeforeClick_selectorItem},{name:"onChange_selectedDS",handler:this.onChange_selectedDS},{name:"onStart_application",handler:this.onStart_application},{name:"onUpdate_componentDimensions",handler:this.onUpdate_componentDimensions}])}b.prototype.changePermaLinkButton=function(){if(true==_.isUndefined(this.collection.get("buttonVal"))){this.collection.add({id:"buttonVal",value:$("#cubeviz-footer-permaLinkButton").html()});this.showLink()}else{this.collection.remove("buttonVal");this.closeLink()}};b.prototype.closeLink=function(){$("#cubeviz-footer-permaLinkMenu").fadeOut("slow")};b.prototype.initialize=function(){this.collection.add({id:"cubeviz-footer-permaLink",html:$("#cubeviz-footer-permaLink").html()});this.render()};b.prototype.onAfterChange_selectedDSD=function(){if(false===_.isUndefined(this.collection.get("buttonVal"))){this.changePermaLinkButton()}};b.prototype.onBeforeClick_selectorItem=function(){if(true==_.isUndefined(this.collection.get("buttonVal"))){}else{var c=this.collection.get("buttonVal").value;this.collection.remove("buttonVal");this.closeLink()}};b.prototype.onChange_selectedDS=function(){this.onAfterChange_selectedDSD()};b.prototype.onClick_permaLinkButton=function(c){this.changePermaLinkButton()};b.prototype.onClick_showVisualization=function(d){var c=this;if(true===cubeVizApp._.backend.uiParts.index.isLoaded){CubeViz_ConfigurationLink.save(this.app._.backend.url,this.app._.backend.modelUrl,this.app._.data,"data",function(e){DataCube_Observation.loadAll(c.app._.backend.url,c.app._.backend.serviceUrl,c.app._.backend.modelUrl,e,"",function(f){c.app._.data.retrievedObservations=f;c.triggerGlobalEvent("onReRender_visualization")});c.app._.backend.dataHash=e})}else{if(false===cubeVizApp._.backend.uiParts.index.isLoaded){CubeViz_ConfigurationLink.save(c.app._.backend.url,c.app._.backend.modelUrl,c.app._.data,"data",function(e){window.location.href=c.app._.backend.url+"?m="+encodeURIComponent(c.app._.backend.modelUrl)+"&cv_dataHash="+e+"&cv_uiHash="+c.app._.backend.uiHash})}else{CubeViz_ConfigurationLink.save(this.app._.backend.url,this.app._.backend.modelUrl,this.app._.data,"data",function(e){window.location.href=c.app._.backend.url+"?m="+encodeURIComponent(c.app._.backend.modelUrl)+"&cv_dataHash="+e+"&cv_uiHash="+c.app._.backend.uiHash})}}};b.prototype.onStart_application=function(){this.initialize()};b.prototype.onUpdate_componentDimensions=function(){if(true==_.isUndefined(this.collection.get("buttonVal"))){}else{var c=this.collection.get("buttonVal").value;this.collection.remove("buttonVal");this.closeLink()}};b.prototype.render=function(){this.bindUserInterfaceEvents({"click #cubeviz-footer-permaLinkButton":this.onClick_permaLinkButton,"click #cubeviz-footer-showVisualizationButton":this.onClick_showVisualization});return this};b.prototype.showLink=function(){var e=this.app._.backend.url+"?";if(false==_.str.isBlank(this.app._.backend.serviceUrl)){e+="serviceUrl="+encodeURIComponent(this.app._.backend.serviceUrl)+"&"}e+="m="+encodeURIComponent(this.app._.backend.modelUrl)+"&cv_dataHash="+this.app._.backend.dataHash+"&cv_uiHash="+this.app._.backend.uiHash;var c=$("<a></a>").attr("href",e).attr("target","_self").html(this.collection.get("cubeviz-footer-permaLink").html);$("#cubeviz-footer-permaLink").html(c);var d=$("#cubeviz-footer-permaLinkButton").position();$("#cubeviz-footer-permaLinkMenu").css("top",(d.top+30)).css("left",(d.left)).fadeIn("slow")};return b})(CubeViz_View_Abstract);var View_IndexAction_ExportArea=(function(a){__extends(b,a);function b(c,d){a.call(this,"View_IndexAction_ExportArea",c,d);this.bindGlobalEvents([{name:"onReRender_visualization",handler:this.onReRender_visualization},{name:"onStart_application",handler:this.onStart_application},{name:"onUpdate_componentDimensions",handler:this.onUpdate_componentDimensions}])}b.prototype.destroy=function(){a.prototype.destroy.call(this);return this};b.prototype.initialize=function(){this.render()};b.prototype.onReRender_visualization=function(){this.initialize()};b.prototype.onStart_application=function(){this.initialize()};b.prototype.onUpdate_componentDimensions=function(){this.initialize()};b.prototype.render=function(){this.setUrlToDownload();return this};b.prototype.setUrlToDownload=function(){var c=this.app._.backend.url+"exportdataselection/?serviceUrl="+encodeURIComponent(this.app._.backend.serviceUrl)+"&dataHash="+this.app._.backend.dataHash;$("#cubeviz-index-exportArea-btnTurtle").attr("href",c+"&type=turtle");$("#cubeviz-index-exportArea-btnCsv").attr("href",c+"&type=csv")};return b})(CubeViz_View_Abstract);var View_IndexAction_Header=(function(b){__extends(a,b);function a(c,d){b.call(this,"View_IndexAction_Header",c,d);this.bindGlobalEvents([{name:"onChange_selectedDS",handler:this.onChange_selectedDS},{name:"onStart_application",handler:this.onStart_application}])}a.prototype.destroy=function(){b.prototype.destroy.call(this);CubeViz_View_Helper.destroyDialog($("#cubeviz-index-headerDialogBox"));return this};a.prototype.initialize=function(){this.render()};a.prototype.onChange_selectedDS=function(){if(false===this.app._.backend.uiSettings.useDataSetInsteadOfModel){$("#cubeviz-index-headerSubheadline").html(CubeViz_View_Helper.tplReplace($("#cubeviz-index-tpl-headerSubheadline").html(),{selectedDataSet:this.app._.data.selectedDS.__cv_niceLabel}))}else{$("#cubeviz-index-header").html(CubeViz_View_Helper.tplReplace($("#cubeviz-index-tpl-headerSubheadline").html(),{selectedDataSet:this.app._.data.selectedDS.__cv_niceLabel}))}};a.prototype.onClick_questionMark=function(){$("#cubeviz-index-headerDialogBox").dialog("open")};a.prototype.onStart_application=function(){this.initialize()};a.prototype.render=function(){CubeViz_View_Helper.attachDialogTo($("#cubeviz-index-headerDialogBox"),{closeOnEscape:true,height:450,showCross:true,width:"50%"});this.renderHeader();this.renderDialogBox();this.bindUserInterfaceEvents({"click #cubeviz-index-headerQuestionMarkHeadline":this.onClick_questionMark});return this};a.prototype.renderDialogBox=function(){var d="";if(false===_.isUndefined(this.app._.backend.modelInformation["http://www.w3.org/2000/01/rdf-schema#label"])&&false===_.str.isBlank(this.app._.backend.modelInformation["http://www.w3.org/2000/01/rdf-schema#label"])){d=this.app._.backend.modelInformation["http://www.w3.org/2000/01/rdf-schema#label"].content}else{d=this.app._.backend.modelUrl}$("#cubeviz-index-headerDialogBox").html(CubeViz_View_Helper.tplReplace($("#cubeviz-index-tpl-headerDialogBoxHead").html(),{label:d}));var c=$($("#cubeviz-index-headerDialogBox").children().last());_.each(this.app._.backend.modelInformation,function(e){c.append(CubeViz_View_Helper.tplReplace($("#cubeviz-index-tpl-headerDialogBoxEntry").html(),{predicateLabel:e.predicateLabel,objectContent:CubeViz_Visualization_Controller.linkify(e.content)}))})};a.prototype.renderHeader=function(){var c;if(false===_.isUndefined(this.app._.backend.modelInformation["http://www.w3.org/2000/01/rdf-schema#label"])&&false===_.str.isBlank(this.app._.backend.modelInformation["http://www.w3.org/2000/01/rdf-schema#label"])){c=this.app._.backend.modelInformation["http://www.w3.org/2000/01/rdf-schema#label"].content}else{c=this.app._.backend.modelUrl}if(false===this.app._.backend.uiSettings.useDataSetInsteadOfModel){$("#cubeviz-index-header").html(CubeViz_View_Helper.tplReplace($("#cubeviz-index-tpl-header").html(),{modelLabel:c}));$("#cubeviz-index-headerSubheadline").html(CubeViz_View_Helper.tplReplace($("#cubeviz-index-tpl-headerSubheadline").html(),{selectedDataSet:this.app._.data.selectedDS.__cv_niceLabel})+$("#cubeviz-index-tpl-headerSubheadlineButtons").html())}else{$("#cubeviz-index-header").html(CubeViz_View_Helper.tplReplace($("#cubeviz-index-tpl-headerSubheadline").html(),{selectedDataSet:this.app._.data.selectedDS.__cv_niceLabel}));$("#cubeviz-index-headerSubheadline").html($("#cubeviz-index-tpl-headerSubheadlineButtons").html())}};return a})(CubeViz_View_Abstract);var View_IndexAction_Legend=(function(a){__extends(b,a);function b(c,d){a.call(this,"View_IndexAction_Legend",c,d);this.bindGlobalEvents([{name:"onReRender_visualization",handler:this.onReRender_visualization},{name:"onStart_application",handler:this.onStart_application}])}b.prototype.destroy=function(){$("#cubeviz-legend-btnShowRetrievedObservations").off();$("#cubeviz-legend-sortByTitle").off();$("#cubeviz-legend-sortByValue").off();$("#cubeviz-legend-retrievedObservations").slideUp("slow");$("#cubeviz-legend-selectedConfiguration").slideUp("slow");$("#cubeviz-legend-dataSet").html("");$("#cubeviz-legend-observations").html("");$("#cubeviz-legend-configurationList").html("");CubeViz_View_Helper.destroyDialog($("#cubeviz-legend-componentDimensionInfoDialog"));a.prototype.destroy.call(this);return this};b.prototype.displayDsdAndDs=function(d,f,e,c){$("#cubeviz-legend-dsdAndDs").html(CubeViz_View_Helper.tplReplace($("#cubeviz-legend-tpl-dsdAndDs").html(),{dsdLabel:d,dsdUrl:f,dsLabel:e,dsUrl:c}))};b.prototype.displayRetrievedObservations=function(e){var d=null;var c="";$("#cubeviz-legend-observations").html("");_.each(e,function(f){$("#cubeviz-legend-observations").append(CubeViz_View_Helper.tplReplace($("#cubeviz-legend-tpl-observation").html(),f));d=$($("#cubeviz-legend-observations").find(".cubeviz-legend-observationInfoList").last());_.each(f.__cv_elements,function(g){d.append(CubeViz_View_Helper.tplReplace($("#cubeviz-legend-tpl-observationInfoListEntry").html(),{dimensionLabel:g.dimensionLabel,fullLabel:g.__cv_niceLabel,__cv_shortLabel:_.str.prune(g.__cv_niceLabel,65,"..."),__cv_uri:g.__cv_uri}))})})};b.prototype.displaySelectedConfiguration=function(d){var i=null;var e=null;var h=null;var c=new CubeViz_Collection("__cv_uri");var g="";var f="";$("#cubeviz-legend-components").html($("#cubeviz-legend-tpl-componentList").html());_.each(d,function(j){$("#cubeviz-legend-componentList").append(CubeViz_View_Helper.tplReplace($("#cubeviz-legend-tpl-componentDimension").html(),{__cv_niceLabel:j.__cv_niceLabel}));h=$($("#cubeviz-legend-componentList").find(".cubeviz-legend-componentDimensionList").last());g="";c.reset().addList(JSON.parse(JSON.stringify(j.__cv_elements))).sortAscendingBy().each(function(k){h.append(CubeViz_View_Helper.tplReplace($("#cubeviz-legend-tpl-componentDimensionEntry").html(),{fullLabel:k.__cv_niceLabel,__cv_shortLabel:_.str.prune(k.__cv_niceLabel,75," ..."),__cv_uri:k.__cv_uri}));e=$(h.find(".cubeviz-legend-observationIcon").last());i=$(h.find(".cubeviz-legend-componentDimensionInfoArea").last());$(h.find(".cubeviz-legend-componentDimensionShowInfo").last()).data("componentDimensionInfoArea",i).data("dimension",j).data("dimensionElement",k).data("observationIcon",e)})})};b.prototype.generateList=function(c,e,h){var j="http://purl.org/linked-data/cube#dimension";var i="";var d=[];var f="";var i="";var g="http://www.w3.org/2000/01/rdf-schema#label";var k=[];_.each(c,function(l){d=[];_.each(e,function(m){_.each(m.__cv_elements,function(n){if(n.__cv_uri==l[m[j]]){d.push({dimensionLabel:m.__cv_niceLabel,__cv_niceLabel:n.__cv_niceLabel,__cv_uri:n.__cv_uri})}})});k.push({__cv_niceLabel:l.__cv_niceLabel,__cv_value:l[h],__cv_uri:l.__cv_uri,__cv_elements:d})});return k};b.prototype.initialize=function(){this.render()};b.prototype.onClick_btnShowSelectedConfiguration=function(c){c.preventDefault();$("#cubeviz-legend-selectedConfiguration").slideToggle("slow");return false};b.prototype.onClick_btnShowRetrievedObservations=function(c){c.preventDefault();$("#cubeviz-legend-retrievedObservations").slideToggle("slow");return false};b.prototype.onClick_componentDimensionShowInfo=function(f){f.preventDefault();var e=$(f.target);var h=e.data("dimension");var g=e.data("dimensionElement");var c=e.data("observationIcon");var d=$($("#cubeviz-legend-tpl-componentDimensionInfoList").html());_.each(g,function(j,i){if(false===_.str.startsWith(i,"__cv_")){d.append(CubeViz_View_Helper.tplReplace($("#cubeviz-legend-tpl-componentDimensionInfoListEntry").html(),{key:i,value:CubeViz_Visualization_Controller.linkify(j)}))}});$("#cubeviz-legend-componentDimensionInfoDialog").html("").append(CubeViz_View_Helper.tplReplace($("#cubeviz-legend-tpl-componentDimensionInfoHeader").html(),g)).append(d).fadeIn("slow");$("#cubeviz-legend-componentDimensionInfoDialog").dialog("open");return false};b.prototype.onClick_sortByTitle=function(){this.collection.sortAscendingBy("__cv_niceLabel");this.displayRetrievedObservations(this.collection._)};b.prototype.onClick_sortByValue=function(){this.collection.sortAscendingBy("__cv_value");this.displayRetrievedObservations(this.collection._)};b.prototype.onReRender_visualization=function(){this.destroy();this.initialize()};b.prototype.onStart_application=function(){this.initialize()};b.prototype.render=function(){var d=this.app._.data.selectedComponents.measure["http://purl.org/linked-data/cube#measure"];var c=this;this.displayDsdAndDs(this.app._.data.selectedDSD.__cv_niceLabel,this.app._.data.selectedDSD.__cv_uri,this.app._.data.selectedDS.__cv_niceLabel,this.app._.data.selectedDS.__cv_uri);this.displaySelectedConfiguration(this.app._.data.selectedComponents.dimensions);this.collection.reset("__cv_niceLabel").addList(this.generateList(this.app._.data.retrievedObservations,this.app._.data.selectedComponents.dimensions,d));this.collection.sortAscendingBy("__cv_niceLabel");this.displayRetrievedObservations(this.collection._);CubeViz_View_Helper.attachDialogTo($("#cubeviz-legend-componentDimensionInfoDialog"),{closeOnEscape:true,showCross:true,height:450,width:"50%"});$("#cubeviz-legend-btnShowRetrievedObservations").off();$("#cubeviz-legend-btnShowSelectedConfiguration").off();$(".cubeviz-legend-componentDimensionShowInfo").off();$("#cubeviz-legend-sortByTitle").off();$("#cubeviz-legend-sortByValue").off();this.bindUserInterfaceEvents({"click #cubeviz-legend-btnShowSelectedConfiguration":this.onClick_btnShowSelectedConfiguration,"click #cubeviz-legend-btnShowRetrievedObservations":this.onClick_btnShowRetrievedObservations,"click .cubeviz-legend-componentDimensionShowInfo":this.onClick_componentDimensionShowInfo,"click #cubeviz-legend-sortByTitle":this.onClick_sortByTitle,"click #cubeviz-legend-sortByValue":this.onClick_sortByValue});return this};return b})(CubeViz_View_Abstract);var View_IndexAction_Visualization=(function(b){__extends(a,b);function a(c,d){b.call(this,"View_IndexAction_Visualization",c,d);this.bindGlobalEvents([{name:"onChange_visualizationClass",handler:this.onChange_visualizationClass},{name:"onReRender_visualization",handler:this.onReRender_visualization},{name:"onStart_application",handler:this.onStart_application}])}a.prototype.destroy=function(){b.prototype.destroy.call(this);return this};a.prototype.handleException=function(c){this.setVisualizationHeight();if(true===_.str.include(c,"Highcharts error #10")){$("#cubeviz-index-visualization").html($("#cubeviz-visualization-tpl-notificationHightchartsException10").html())}else{if(true===_.str.include(c,"CubeViz error no observations retrieved")){$("#cubeviz-index-visualization").html($("#cubeviz-visualization-tpl-nothingFoundNotification").text());this.triggerGlobalEvent("onReceived_noData")}else{if(true===_.str.include(c,"CubeViz error no elements to visualize")){$("#cubeviz-index-visualization").html("CubeViz error no elements to visualize");this.triggerGlobalEvent("onVisualize_noElements")}}}if(false===_.isUndefined(console)&&false===_.isUndefined(console.log)){console.log(c)}};a.prototype.initialize=function(){this.render()};a.prototype.onChange_visualizationClass=function(){this.render()};a.prototype.onClick_nothingFoundNotificationLink=function(c){$("#cubeviz-visualization-nothingFoundFurtherExplanation").slideDown("slow")};a.prototype.onReRender_visualization=function(){this.render()};a.prototype.onStart_application=function(){this.initialize()};a.prototype.render=function(){if(0==_.size(this.app._.data.retrievedObservations)){this.handleException("CubeViz error no observations retrieved");return this}var i=CubeViz_Visualization_Controller.getFromChartConfigByClass(this.app._.ui.visualization.className,this.app._.backend.chartConfig[this.app._.data.numberOfMultipleDimensions].charts);var c=this.app._.data.selectedComponents.measure;var h=null;var f=null;if(true===_.isUndefined(i)){this.app._.ui.visualization.className=this.app._.backend.chartConfig[this.app._.data.numberOfMultipleDimensions].charts[0].className;i=CubeViz_Visualization_Controller.getFromChartConfigByClass(this.app._.ui.visualization.className,this.app._.backend.chartConfig[this.app._.data.numberOfMultipleDimensions].charts)}f=CubeViz_Visualization_Controller.updateVisualizationSettings([],this.app._.ui.visualizationSettings[this.app._.ui.visualization.className],i.defaultConfig);h=CubeViz_Visualization_Controller.getVisualizationType(this.app._.ui.visualization.className);var d=null;if((false===_.isNull(this.app._.data.selectedComponents.attribute)&&false===_.isUndefined(this.app._.data.selectedComponents.attribute))){if(false===this.app._.data.selectedComponents.attribute.__cv_inUse){}else{d=this.app._.data.selectedComponents.attribute["http://purl.org/linked-data/cube#attribute"]}}if(false===_.isUndefined(this.app._.generatedVisualization)){try{this.app._.generatedVisualization.destroy()}catch(e){if(false===_.isUndefined(console)&&false===_.isUndefined(console.log)){console.log(e)}}}var j=new CubeViz_Visualization_HighCharts();var g=j.load(this.app._.ui.visualization.className);g.init(f,this.app._.data.retrievedObservations,this.app._.data.selectedComponents.dimensions,CubeViz_Visualization_Controller.getMultipleDimensions(this.app._.data.selectedComponents.dimensions),CubeViz_Visualization_Controller.getOneElementDimensions(this.app._.data.selectedComponents.dimensions),c["http://purl.org/linked-data/cube#measure"],d);try{this.setVisualizationHeight(_.size(g.getRenderResult().xAxis.categories));if(0==_.size(g.getRenderResult().series)){this.handleException("CubeViz error no elements to visualize");return this}this.app._.generatedVisualization=new Highcharts.Chart(g.getRenderResult())}catch(e){this.handleException(e)}return this};a.prototype.setVisualizationHeight=function(c){if(typeof c==="undefined"){c=0}var f=$(this.attachedTo).offset();var e=$(window).height()-f.top-105;var d=0;if(0<c){d=c*40;if(d>e){e=d}}$(this.attachedTo).css("height",e)};return a})(CubeViz_View_Abstract);var View_IndexAction_VisualizationSelector=(function(b){__extends(a,b);function a(c,d){b.call(this,"View_IndexAction_VisualizationSelector",c,d);this.bindGlobalEvents([{name:"onClick_setupComponentOpener",handler:this.onClick_setupComponentOpener},{name:"onReceived_noData",handler:this.onReceived_noData},{name:"onReRender_visualization",handler:this.onReRender_visualization},{name:"onStart_application",handler:this.onStart_application},{name:"onVisualize_noElements",handler:this.onVisualize_noElements}])}a.prototype.destroy=function(){b.prototype.destroy.call(this);$("#cubeviz-visualizationselector-selector").empty();this.hideDongle();this.hideMenu();return this};a.prototype.hideDongle=function(){$("#cubeviz-visualizationselector-menuDongleDiv").fadeOut("slow");return this};a.prototype.hideMenu=function(){this.triggerGlobalEvent("onBeforeHide_visualizationSelectorMenu");$("#cubeviz-visualizationselector-menu").fadeOut("slow");$("#cubeviz-visualizationselector-menuItems").html("");this.triggerGlobalEvent("onAfterHide_visualizationSelectorMenu");return this};a.prototype.initialize=function(){this.render()};a.prototype.onClick_setupComponentOpener=function(){this.hideMenu()};a.prototype.onClick_closeMenu=function(){this.hideMenu()};a.prototype.onClick_selectorItem=function(e){this.triggerGlobalEvent("onBeforeClick_selectorItem");var f="";var c=null;var d=this;if(true===_.isUndefined($(e.target).data("class"))){c=$($(e.target).parent());this.app._.ui.visualization.className=c.data("class")}else{c=$(e.target);this.app._.ui.visualization.className=c.data("class")}f=$($(".cubeviz-visualizationselector-selectedSelectorItem").get(0)).data("class");this.hideDongle();if(f==this.app._.ui.visualization.className){this.showMenu(c)}else{this.hideMenu();$(".cubeviz-visualizationselector-selectedSelectorItem").removeClass("cubeviz-visualizationselector-selectedSelectorItem").addClass("cubeviz-visualizationselector-selectorItem");c.removeClass("cubeviz-visualizationselector-selectorItem").addClass("cubeviz-visualizationselector-selectedSelectorItem");this.showMenuDongle(c);this.triggerGlobalEvent("onChange_visualizationClass");CubeViz_ConfigurationLink.save(this.app._.backend.url,this.app._.backend.modelUrl,this.app._.ui,"ui",function(g){d.app._.backend.uiHash=g})}this.triggerGlobalEvent("onAfterClick_selectorItem")};a.prototype.onClick_updateVisz=function(){var d=CubeViz_Visualization_Controller.getFromChartConfigByClass(this.app._.ui.visualization.className,this.app._.backend.chartConfig[this.app._.data.numberOfMultipleDimensions].charts);var c=this;this.app._.ui.visualizationSettings[this.app._.ui.visualization.className]=CubeViz_Visualization_Controller.updateVisualizationSettings($(".cubeviz-visualizationselector-menuItemValue"),this.app._.ui.visualizationSettings[this.app._.ui.visualization.className],d.defaultConfig);CubeViz_ConfigurationLink.save(this.app._.backend.url,this.app._.backend.modelUrl,this.app._.ui,"ui",function(e){c.app._.backend.uiHash=e});this.triggerGlobalEvent("onReRender_visualization")};a.prototype.onReceived_noData=function(){this.hideDongle()};a.prototype.onReRender_visualization=function(){this.destroy();if(0<_.size(this.app._.data.retrievedObservations)){this.initialize()}};a.prototype.onStart_application=function(){if(0<_.size(this.app._.data.retrievedObservations)){this.initialize()}};a.prototype.onVisualize_noElements=function(){this.hideDongle().hideMenu()};a.prototype.render=function(){this.triggerGlobalEvent("onBeforeRender_visualizationSelector");var g=this.app._.data.numberOfMultipleDimensions;var f=this.app._.backend.chartConfig[g].charts;var c;var d=this;var e;this.hideDongle();_.each(f,function(h){e=$(CubeViz_View_Helper.tplReplace($("#cubeviz-visualizationselector-tpl-selectorItem").html()));$(e.find(".cubeviz-icon-small").first()).attr("src",d.app._.backend.imagesPath+h.icon);e.data("class",h.className);e.off("click");e.on("click",$.proxy(d.onClick_selectorItem,d));if(d.app._.ui.visualization.className==h.className){e.addClass("cubeviz-visualizationselector-selectedSelectorItem").removeClass("cubeviz-visualizationselector-selectorItem")}$("#cubeviz-visualizationselector-selector").append(e)});this.showMenuDongle($($("#cubeviz-visualizationselector-selector").find(".cubeviz-visualizationselector-selectedSelectorItem").first()));this.bindUserInterfaceEvents({});this.triggerGlobalEvent("onAfterRender_visualizationSelector");return this};a.prototype.showMenu=function(f){this.triggerGlobalEvent("onBeforeShow_visualizationSelectorMenu");var k=false;var i="";var e=CubeViz_Visualization_Controller.getFromChartConfigByClass(this.app._.ui.visualization.className,this.app._.backend.chartConfig[this.app._.data.numberOfMultipleDimensions].charts);var c;var j=$("#cubeviz-visualizationselector-menuItems").html();var g=f.position();var l;var h=this.app._.ui.visualizationSettings[this.app._.ui.visualization.className];var d;if(false===_.isUndefined(e.options)&&0<_.size(e.options)&&(""==j||null==j)){_.each(e.options,function(m){k=false;c=$(CubeViz_View_Helper.tplReplace($("#cubeviz-visualizationselector-tpl-menuItem").html(),m));l=$(c.find(".cubeviz-visualizationselector-menuSelectbox").get(0));i=CubeViz_Visualization_Controller.getObjectValueByKeyString(m.key,h);d=$("<option/>");l.data("key",m.key);if(false==_.isUndefined(i)){_.each(m.values,function(n){n.value=n.value.toString();if(i.toString()==n.value&&false==k){d=$("<option/>");d.text(n.label).val(n.value).attr("selected","selected");l.append(d);k=true}})}_.each(m.values,function(n){n.value=n.value.toString();if(false==_.isUndefined(i)&&i.toString()==n.value){return}d=$("<option/>");d.text(n.label).val(n.value);if(false===k&&false===_.isUndefined(n.isDefault)&&true===n.isDefault){d.attr("selected","selected");k=true}l.append(d)});$("#cubeviz-visualizationselector-menuItems").append(c)});$("#cubeviz-visualizationselector-closeMenu").off("click");$("#cubeviz-visualizationselector-closeMenu").on("click",$.proxy(this.onClick_closeMenu,this));$("#cubeviz-visualizationselector-updateVisz").off("click");$("#cubeviz-visualizationselector-updateVisz").on("click",$.proxy(this.onClick_updateVisz,this));$("#cubeviz-visualizationselector-menu").css("top",g.top+37).css("left",g.left-192).fadeIn("slow")}this.triggerGlobalEvent("onAfterShow_visualizationSelectorMenu")};a.prototype.showMenuDongle=function(d){var f=this.app._.backend.chartConfig[this.app._.data.numberOfMultipleDimensions].charts;var e=CubeViz_Visualization_Controller.getFromChartConfigByClass(this.app._.ui.visualization.className,f);if(false===_.isUndefined(e.options)&&0<_.size(e.options)){var c=d.position();$("#cubeviz-visualizationselector-menuDongleDiv").css("top",c.top+25).css("left",c.left+14).fadeIn("slow")}};return a})(CubeViz_View_Abstract);var View_ModelinfoAction_Footer=(function(b){__extends(a,b);function a(c,d){b.call(this,"View_Modelinfo_Footer",c,d);this.bindGlobalEvents([{name:"onStart_application",handler:this.onStart_application}])}a.prototype.initialize=function(){this.render()};a.prototype.onClick_showAnalyzeBtn=function(){window.location.href=this.app._.backend.url+"analyze/"};a.prototype.onClick_showVisualizationBtn=function(){$("#cubeviz-footer-showVisualizationButton").click()};a.prototype.onStart_application=function(){this.initialize()};a.prototype.render=function(){this.bindUserInterfaceEvents({"click #cubeviz-modelinfo-showAnalyzeBtn":this.onClick_showAnalyzeBtn,"click #cubeviz-modelinfo-showVisualizationBtn":this.onClick_showVisualizationBtn});return this};return a})(CubeViz_View_Abstract);var cubeVizApp=new CubeViz_View_Application();$(document).ready(function(){if(0<_.size(cubeVizApp._)&&"development"==cubeVizApp._.backend.context){console.log("CubeViz - Development Information:");console.log(cubeVizApp._)}cubeVizApp.triggerEvent("onStart_application")});